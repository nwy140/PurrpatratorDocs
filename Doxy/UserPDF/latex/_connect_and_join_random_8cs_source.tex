\doxysection{Connect\+And\+Join\+Random.\+cs}
\label{_connect_and_join_random_8cs_source}\index{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/PhotonUnityNetworking/UtilityScripts/Prototyping/ConnectAndJoinRandom.cs@{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/PhotonUnityNetworking/UtilityScripts/Prototyping/ConnectAndJoinRandom.cs}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002 \textcolor{comment}{// <copyright file="{}ConnectAndJoinRandom.cs"{} company="{}Exit Games GmbH"{}>}}
\DoxyCodeLine{00003 \textcolor{comment}{//   Part of: Photon Unity Utilities, }}
\DoxyCodeLine{00004 \textcolor{comment}{// </copyright>}}
\DoxyCodeLine{00005 \textcolor{comment}{// <summary>}}
\DoxyCodeLine{00006 \textcolor{comment}{//  Simple component to call ConnectUsingSettings and to get into a PUN room easily.}}
\DoxyCodeLine{00007 \textcolor{comment}{// </summary>}}
\DoxyCodeLine{00008 \textcolor{comment}{// <remarks>}}
\DoxyCodeLine{00009 \textcolor{comment}{//  A custom inspector provides a button to connect in PlayMode, should AutoConnect be false.}}
\DoxyCodeLine{00010 \textcolor{comment}{//  </remarks>                                                                                               }}
\DoxyCodeLine{00011 \textcolor{comment}{// <author>developer@exitgames.com</author>}}
\DoxyCodeLine{00012 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00013 }
\DoxyCodeLine{00014 \textcolor{comment}{//\#if UNITY\_EDITOR}}
\DoxyCodeLine{00015 \textcolor{comment}{//using UnityEditor;}}
\DoxyCodeLine{00016 \textcolor{comment}{//\#endif}}
\DoxyCodeLine{00017 }
\DoxyCodeLine{00018 \textcolor{keyword}{using} UnityEngine;}
\DoxyCodeLine{00019 }
\DoxyCodeLine{00020 \textcolor{comment}{//using Photon.Pun;}}
\DoxyCodeLine{00021 \textcolor{keyword}{using} Photon.Realtime;}
\DoxyCodeLine{00022 }
\DoxyCodeLine{00023 \textcolor{keyword}{namespace }Photon.Pun.UtilityScripts}
\DoxyCodeLine{00024 \{}
\DoxyCodeLine{00027     \textcolor{keyword}{public} \textcolor{keyword}{class }ConnectAndJoinRandom : MonoBehaviourPunCallbacks}
\DoxyCodeLine{00028     \{}
\DoxyCodeLine{00030         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} AutoConnect = \textcolor{keyword}{true};}
\DoxyCodeLine{00031 }
\DoxyCodeLine{00033         \textcolor{keyword}{public} \textcolor{keywordtype}{byte} Version = 1;}
\DoxyCodeLine{00034 }
\DoxyCodeLine{00036         [Tooltip(\textcolor{stringliteral}{"{}The max number of players allowed in room. Once full, a new room will be created by the next connection attemping to join."{}})]}
\DoxyCodeLine{00037         \textcolor{keyword}{public} \textcolor{keywordtype}{byte} MaxPlayers = 4;}
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039         \textcolor{keyword}{public} \textcolor{keywordtype}{int} playerTTL = -\/1;}
\DoxyCodeLine{00040 }
\DoxyCodeLine{00041         \textcolor{keyword}{public} \textcolor{keywordtype}{void} Start()}
\DoxyCodeLine{00042         \{}
\DoxyCodeLine{00043             \textcolor{keywordflow}{if} (this.AutoConnect)}
\DoxyCodeLine{00044             \{}
\DoxyCodeLine{00045                 this.ConnectNow();}
\DoxyCodeLine{00046             \}}
\DoxyCodeLine{00047         \}}
\DoxyCodeLine{00048 }
\DoxyCodeLine{00049         \textcolor{keyword}{public} \textcolor{keywordtype}{void} ConnectNow()}
\DoxyCodeLine{00050         \{}
\DoxyCodeLine{00051             Debug.Log(\textcolor{stringliteral}{"{}ConnectAndJoinRandom.ConnectNow() will now call: PhotonNetwork.ConnectUsingSettings()."{}});}
\DoxyCodeLine{00052 }
\DoxyCodeLine{00053             }
\DoxyCodeLine{00054             PhotonNetwork.ConnectUsingSettings();}
\DoxyCodeLine{00055             PhotonNetwork.GameVersion = this.Version + \textcolor{stringliteral}{"{}."{}} + SceneManagerHelper.ActiveSceneBuildIndex;}
\DoxyCodeLine{00056            }
\DoxyCodeLine{00057         \}}
\DoxyCodeLine{00058 }
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060         \textcolor{comment}{// below, we implement some callbacks of the Photon Realtime API.}}
\DoxyCodeLine{00061         \textcolor{comment}{// Being a MonoBehaviourPunCallbacks means, we can override the few methods which are needed here.}}
\DoxyCodeLine{00062 }
\DoxyCodeLine{00063 }
\DoxyCodeLine{00064         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{void} OnConnectedToMaster()}
\DoxyCodeLine{00065         \{}
\DoxyCodeLine{00066             Debug.Log(\textcolor{stringliteral}{"{}OnConnectedToMaster() was called by PUN. This client is now connected to Master Server in region ["{}} + PhotonNetwork.CloudRegion +}
\DoxyCodeLine{00067                 \textcolor{stringliteral}{"{}] and can join a room. Calling: PhotonNetwork.JoinRandomRoom();"{}});}
\DoxyCodeLine{00068             PhotonNetwork.JoinRandomRoom();}
\DoxyCodeLine{00069         \}}
\DoxyCodeLine{00070 }
\DoxyCodeLine{00071         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{void} OnJoinedLobby()}
\DoxyCodeLine{00072         \{}
\DoxyCodeLine{00073             Debug.Log(\textcolor{stringliteral}{"{}OnJoinedLobby(). This client is now connected to Relay in region ["{}} + PhotonNetwork.CloudRegion + \textcolor{stringliteral}{"{}]. This script now calls: PhotonNetwork.JoinRandomRoom();"{}});}
\DoxyCodeLine{00074             PhotonNetwork.JoinRandomRoom();}
\DoxyCodeLine{00075         \}}
\DoxyCodeLine{00076 }
\DoxyCodeLine{00077         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{void} OnJoinRandomFailed(\textcolor{keywordtype}{short} returnCode, \textcolor{keywordtype}{string} message)}
\DoxyCodeLine{00078         \{}
\DoxyCodeLine{00079             Debug.Log(\textcolor{stringliteral}{"{}OnJoinRandomFailed() was called by PUN. No random room available in region ["{}} + PhotonNetwork.CloudRegion + \textcolor{stringliteral}{"{}], so we create one. Calling: PhotonNetwork.CreateRoom(null, new RoomOptions() \{maxPlayers = 4\}, null);"{}});}
\DoxyCodeLine{00080 }
\DoxyCodeLine{00081             RoomOptions roomOptions = \textcolor{keyword}{new} RoomOptions() \{ MaxPlayers = this.MaxPlayers \};}
\DoxyCodeLine{00082             \textcolor{keywordflow}{if} (playerTTL >= 0)}
\DoxyCodeLine{00083                 roomOptions.PlayerTtl = playerTTL;}
\DoxyCodeLine{00084 }
\DoxyCodeLine{00085             PhotonNetwork.CreateRoom(\textcolor{keyword}{null}, roomOptions, \textcolor{keyword}{null});}
\DoxyCodeLine{00086         \}}
\DoxyCodeLine{00087 }
\DoxyCodeLine{00088         \textcolor{comment}{// the following methods are implemented to give you some context. re-\/implement them as needed.}}
\DoxyCodeLine{00089         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{void} OnDisconnected(DisconnectCause cause)}
\DoxyCodeLine{00090         \{}
\DoxyCodeLine{00091             Debug.Log(\textcolor{stringliteral}{"{}OnDisconnected("{}} + cause + \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{00092         \}}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{void} OnJoinedRoom()}
\DoxyCodeLine{00095         \{}
\DoxyCodeLine{00096             Debug.Log(\textcolor{stringliteral}{"{}OnJoinedRoom() called by PUN. Now this client is in a room in region ["{}} + PhotonNetwork.CloudRegion + \textcolor{stringliteral}{"{}]. Game is now running."{}});}
\DoxyCodeLine{00097         \}}
\DoxyCodeLine{00098     \}}
\DoxyCodeLine{00099 }
\DoxyCodeLine{00100 }
\DoxyCodeLine{00101     \textcolor{comment}{//\#if UNITY\_EDITOR}}
\DoxyCodeLine{00102     \textcolor{comment}{//[CanEditMultipleObjects]}}
\DoxyCodeLine{00103     \textcolor{comment}{//[CustomEditor(typeof(ConnectAndJoinRandom), true)]}}
\DoxyCodeLine{00104     \textcolor{comment}{//public class ConnectAndJoinRandomInspector : Editor}}
\DoxyCodeLine{00105     \textcolor{comment}{//\{}}
\DoxyCodeLine{00106     \textcolor{comment}{//    void OnEnable() \{ EditorApplication.update += Update; \}}}
\DoxyCodeLine{00107     \textcolor{comment}{//    void OnDisable() \{ EditorApplication.update -\/= Update; \}}}
\DoxyCodeLine{00108 }
\DoxyCodeLine{00109     \textcolor{comment}{//    bool isConnectedCache = false;}}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111     \textcolor{comment}{//    void Update()}}
\DoxyCodeLine{00112     \textcolor{comment}{//    \{}}
\DoxyCodeLine{00113     \textcolor{comment}{//        if (this.isConnectedCache != PhotonNetwork.IsConnected)}}
\DoxyCodeLine{00114     \textcolor{comment}{//        \{}}
\DoxyCodeLine{00115     \textcolor{comment}{//            this.Repaint();}}
\DoxyCodeLine{00116     \textcolor{comment}{//        \}}}
\DoxyCodeLine{00117     \textcolor{comment}{//    \}}}
\DoxyCodeLine{00118 }
\DoxyCodeLine{00119     \textcolor{comment}{//    public override void OnInspectorGUI()}}
\DoxyCodeLine{00120     \textcolor{comment}{//    \{}}
\DoxyCodeLine{00121     \textcolor{comment}{//        this.isConnectedCache = !PhotonNetwork.IsConnected;}}
\DoxyCodeLine{00122 }
\DoxyCodeLine{00123 }
\DoxyCodeLine{00124     \textcolor{comment}{//        this.DrawDefaultInspector(); // Draw the normal inspector}}
\DoxyCodeLine{00125 }
\DoxyCodeLine{00126     \textcolor{comment}{//        if (Application.isPlaying \&\& !PhotonNetwork.IsConnected)}}
\DoxyCodeLine{00127     \textcolor{comment}{//        \{}}
\DoxyCodeLine{00128     \textcolor{comment}{//            if (GUILayout.Button("{}Connect"{}))}}
\DoxyCodeLine{00129     \textcolor{comment}{//            \{}}
\DoxyCodeLine{00130     \textcolor{comment}{//                ((ConnectAndJoinRandom)this.target).ConnectNow();}}
\DoxyCodeLine{00131     \textcolor{comment}{//            \}}}
\DoxyCodeLine{00132     \textcolor{comment}{//        \}}}
\DoxyCodeLine{00133     \textcolor{comment}{//    \}}}
\DoxyCodeLine{00134     \textcolor{comment}{//\}}}
\DoxyCodeLine{00135     \textcolor{comment}{//\#endif}}
\DoxyCodeLine{00136 \}}

\end{DoxyCode}
