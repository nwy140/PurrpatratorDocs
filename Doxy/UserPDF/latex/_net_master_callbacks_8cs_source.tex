\doxysection{Net\+Master\+Callbacks.\+cs}
\label{_net_master_callbacks_8cs_source}\index{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/Simple/Core/NetMaster/NetMasterCallbacks.cs@{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/Simple/Core/NetMaster/NetMasterCallbacks.cs}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002 \textcolor{comment}{// <copyright>PhotonNetwork Framework for Unity -\/ Copyright (C) 2020 Exit Games GmbH</copyright>}}
\DoxyCodeLine{00003 \textcolor{comment}{// <author>developer@exitgames.com</author>}}
\DoxyCodeLine{00004 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00005 }
\DoxyCodeLine{00006 \textcolor{keyword}{using} Photon.Pun.Simple.Internal;}
\DoxyCodeLine{00007 \textcolor{keyword}{using} System.Collections.Generic;}
\DoxyCodeLine{00008 }
\DoxyCodeLine{00009 \textcolor{keyword}{namespace }Photon.Pun.Simple}
\DoxyCodeLine{00010 \{}
\DoxyCodeLine{00011     \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{class }NetMasterCallbacks}
\DoxyCodeLine{00012     \{}
\DoxyCodeLine{00013 }
\DoxyCodeLine{00014 \textcolor{preprocessor}{        \#region Outgoing Callbacks}}
\DoxyCodeLine{00015 }
\DoxyCodeLine{00016         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnTickPreSerialization> onTickPreSerializations = \textcolor{keyword}{new} List<IOnTickPreSerialization>();}
\DoxyCodeLine{00017 }
\DoxyCodeLine{00018         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnPreUpdate> onPreUpdates = \textcolor{keyword}{new} List<IOnPreUpdate>();}
\DoxyCodeLine{00019         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnPostUpdate> onPostUpdates = \textcolor{keyword}{new} List<IOnPostUpdate>();}
\DoxyCodeLine{00020 }
\DoxyCodeLine{00021         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnPreLateUpdate> onPreLateUpdates = \textcolor{keyword}{new} List<IOnPreLateUpdate>();}
\DoxyCodeLine{00022         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnPostLateUpdate> onPostLateUpdates = \textcolor{keyword}{new} List<IOnPostLateUpdate>();}
\DoxyCodeLine{00023 }
\DoxyCodeLine{00024         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnIncrementFrame> onIncrementFrames = \textcolor{keyword}{new} List<IOnIncrementFrame>();}
\DoxyCodeLine{00025         \textcolor{comment}{//public static List<IOnCaptureInputs> onCaptureInputs = new List<IOnCaptureInputs>();}}
\DoxyCodeLine{00026 }
\DoxyCodeLine{00027         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnPreSimulate> onPreSimulates = \textcolor{keyword}{new} List<IOnPreSimulate>();}
\DoxyCodeLine{00028         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnPostSimulate> onPostSimulates = \textcolor{keyword}{new} List<IOnPostSimulate>();}
\DoxyCodeLine{00029 }
\DoxyCodeLine{00030         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnTickSnapshot> onSnapshots = \textcolor{keyword}{new} List<IOnTickSnapshot>();}
\DoxyCodeLine{00031         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnInterpolate> onInterpolates = \textcolor{keyword}{new} List<IOnInterpolate>();}
\DoxyCodeLine{00032 }
\DoxyCodeLine{00033         \textcolor{keyword}{public} \textcolor{keyword}{static} List<IOnPreQuit> onPreQuits = \textcolor{keyword}{new} List<IOnPreQuit>();}
\DoxyCodeLine{00034 }
\DoxyCodeLine{00038         \textcolor{keyword}{public} \textcolor{keyword}{static} Queue<System.Action> postCallbackActions = \textcolor{keyword}{new} Queue<System.Action>();}
\DoxyCodeLine{00042         \textcolor{keyword}{public} \textcolor{keyword}{static} Queue<System.Action> postSimulateActions = \textcolor{keyword}{new} Queue<System.Action>();}
\DoxyCodeLine{00043 }
\DoxyCodeLine{00044         \textcolor{keyword}{public} \textcolor{keyword}{static} Queue<System.Action> postSerializationActions = \textcolor{keyword}{new} Queue<System.Action>();}
\DoxyCodeLine{00045 }
\DoxyCodeLine{00046         \textcolor{keyword}{public} \textcolor{keyword}{struct }DelayedRegistrationItem}
\DoxyCodeLine{00047         \{}
\DoxyCodeLine{00048             \textcolor{keyword}{public} \textcolor{keywordtype}{object} comp;}
\DoxyCodeLine{00049             \textcolor{keyword}{public} \textcolor{keywordtype}{bool} \textcolor{keyword}{register};}
\DoxyCodeLine{00050             \textcolor{keyword}{public} DelayedRegistrationItem(\textcolor{keywordtype}{object} comp, \textcolor{keywordtype}{bool} \textcolor{keyword}{register}) \{ this.comp = comp; this.\textcolor{keyword}{register} = \textcolor{keyword}{register}; \}}
\DoxyCodeLine{00051         \}}
\DoxyCodeLine{00052         \textcolor{keyword}{public} \textcolor{keyword}{static} Queue<DelayedRegistrationItem> pendingRegistrations = \textcolor{keyword}{new} Queue<DelayedRegistrationItem>();}
\DoxyCodeLine{00056         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} RegisterCallbackInterfaces(\textcolor{keywordtype}{object} comp, \textcolor{keywordtype}{bool} \textcolor{keyword}{register} = \textcolor{keyword}{true}, \textcolor{keywordtype}{bool} delay = \textcolor{keyword}{false})}
\DoxyCodeLine{00057         \{}
\DoxyCodeLine{00058 }
\DoxyCodeLine{00059             \textcolor{keywordflow}{if} (delay || callbacksLocked)}
\DoxyCodeLine{00060             \{}
\DoxyCodeLine{00061                 pendingRegistrations.Enqueue(\textcolor{keyword}{new} DelayedRegistrationItem(comp, \textcolor{keyword}{register}));}
\DoxyCodeLine{00062                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{00063             \}}
\DoxyCodeLine{00064             \textcolor{comment}{//if ((comp as Object) \&\& register == false)}}
\DoxyCodeLine{00065             \textcolor{comment}{//  Debug.LogError((comp as Object).name + "{}  UNREGISTER"{});}}
\DoxyCodeLine{00066 }
\DoxyCodeLine{00067             CallbackUtilities.RegisterInterface(onPreUpdates, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00068             CallbackUtilities.RegisterInterface(onPostUpdates, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00069 }
\DoxyCodeLine{00070             CallbackUtilities.RegisterInterface(onPreLateUpdates, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00071             CallbackUtilities.RegisterInterface(onPostLateUpdates, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00072 }
\DoxyCodeLine{00073             CallbackUtilities.RegisterInterface(onIncrementFrames, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00074 }
\DoxyCodeLine{00075             CallbackUtilities.RegisterInterface(onPreSimulates, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00076             CallbackUtilities.RegisterInterface(onPostSimulates, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00077 }
\DoxyCodeLine{00078             CallbackUtilities.RegisterInterface(onSnapshots, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00079             CallbackUtilities.RegisterInterface(onInterpolates, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00080             CallbackUtilities.RegisterInterface(onPreQuits, comp, \textcolor{keyword}{register});}
\DoxyCodeLine{00081         \}}
\DoxyCodeLine{00082 }
\DoxyCodeLine{00083 \textcolor{preprocessor}{        \#endregion}}
\DoxyCodeLine{00084 }
\DoxyCodeLine{00085         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} callbacksLocked;}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} CallbacksLocked}
\DoxyCodeLine{00088         \{}
\DoxyCodeLine{00089             \textcolor{keyword}{set}}
\DoxyCodeLine{00090             \{}
\DoxyCodeLine{00091                 callbacksLocked = value;}
\DoxyCodeLine{00092 }
\DoxyCodeLine{00093                 \textcolor{keywordflow}{if} (!value)}
\DoxyCodeLine{00094                 \{}
\DoxyCodeLine{00096                     \textcolor{keywordflow}{while} (pendingRegistrations.Count > 0)}
\DoxyCodeLine{00097                     \{}
\DoxyCodeLine{00098                         var que = pendingRegistrations.Dequeue();}
\DoxyCodeLine{00099                         RegisterCallbackInterfaces(que.comp, que.register, \textcolor{keyword}{false});}
\DoxyCodeLine{00100                     \}}
\DoxyCodeLine{00101 }
\DoxyCodeLine{00102                     \textcolor{keywordflow}{while} (postCallbackActions.Count > 0)}
\DoxyCodeLine{00103                     \{}
\DoxyCodeLine{00104                         postCallbackActions.Dequeue().Invoke();}
\DoxyCodeLine{00105                     \}}
\DoxyCodeLine{00106                 \}}
\DoxyCodeLine{00107             \}}
\DoxyCodeLine{00108         \}}
\DoxyCodeLine{00109 }
\DoxyCodeLine{00110         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnPreQuitCallbacks()}
\DoxyCodeLine{00111         \{}
\DoxyCodeLine{00112             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00113             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onPreQuits.Count; i < cnt; i++)}
\DoxyCodeLine{00114                 onPreQuits[i].OnPreQuit();}
\DoxyCodeLine{00115             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00116         \}}
\DoxyCodeLine{00117 }
\DoxyCodeLine{00118         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnPreUpdateCallbacks()}
\DoxyCodeLine{00119         \{}
\DoxyCodeLine{00120             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00121             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onPreUpdates.Count; i < cnt; ++i)}
\DoxyCodeLine{00122                 onPreUpdates[i].OnPreUpdate();}
\DoxyCodeLine{00123             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00124         \}}
\DoxyCodeLine{00125 }
\DoxyCodeLine{00126         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnInterpolateCallbacks(\textcolor{keywordtype}{int} \_prevFrameId, \textcolor{keywordtype}{int} \_currFrameId, \textcolor{keywordtype}{float} t)}
\DoxyCodeLine{00127         \{}
\DoxyCodeLine{00128             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00129             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onInterpolates.Count; i < cnt; ++i)}
\DoxyCodeLine{00130                 onInterpolates[i].OnInterpolate(\_prevFrameId, \_currFrameId, t);}
\DoxyCodeLine{00131             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00132         \}}
\DoxyCodeLine{00133 }
\DoxyCodeLine{00134         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnPreLateUpdateCallbacks()}
\DoxyCodeLine{00135         \{}
\DoxyCodeLine{00136             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00137             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onPreLateUpdates.Count; i < cnt; ++i)}
\DoxyCodeLine{00138                 onPreLateUpdates[i].OnPreLateUpdate();}
\DoxyCodeLine{00139             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00140 }
\DoxyCodeLine{00141         \}}
\DoxyCodeLine{00142 }
\DoxyCodeLine{00143         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnPostSimulateCallbacks(\textcolor{keywordtype}{int} \_currFrameId, \textcolor{keywordtype}{int} \_currSubFrameId, \textcolor{keywordtype}{bool} isNetTick)}
\DoxyCodeLine{00144         \{}
\DoxyCodeLine{00145             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00146             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onPostSimulates.Count; i < cnt; ++i)}
\DoxyCodeLine{00147                 onPostSimulates[i].OnPostSimulate(\_currFrameId, \_currSubFrameId, isNetTick);}
\DoxyCodeLine{00148             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00149         \}}
\DoxyCodeLine{00150 }
\DoxyCodeLine{00151         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnIncrementFrameCallbacks(\textcolor{keywordtype}{int} \_currFrameId, \textcolor{keywordtype}{int} \_currSubFrameId, \textcolor{keywordtype}{int} \_prevFrameId, \textcolor{keywordtype}{int} \_prevSubFrameId)}
\DoxyCodeLine{00152         \{}
\DoxyCodeLine{00153             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00154             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onIncrementFrames.Count; i < cnt; ++i)}
\DoxyCodeLine{00155                 onIncrementFrames[i].OnIncrementFrame(\_currFrameId, \_currSubFrameId, \_prevFrameId, \_prevSubFrameId);}
\DoxyCodeLine{00156             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00157         \}}
\DoxyCodeLine{00158 }
\DoxyCodeLine{00159         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnSnapshotCallbacks(\textcolor{keywordtype}{int} \_currFrameId)}
\DoxyCodeLine{00160         \{}
\DoxyCodeLine{00161             \textcolor{comment}{// Snapshot Others}}
\DoxyCodeLine{00162             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00163             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onSnapshots.Count; i < cnt; ++i)}
\DoxyCodeLine{00164                 onSnapshots[i].OnSnapshot(\_currFrameId);}
\DoxyCodeLine{00165             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00166 }
\DoxyCodeLine{00167             \textcolor{keywordflow}{while} (postSimulateActions.Count > 0)}
\DoxyCodeLine{00168             \{}
\DoxyCodeLine{00169                 var action = postSimulateActions.Dequeue();}
\DoxyCodeLine{00170                 action.Invoke();}
\DoxyCodeLine{00171             \}}
\DoxyCodeLine{00172         \}}
\DoxyCodeLine{00173 }
\DoxyCodeLine{00174         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnPreSerializeTickCallbacks(\textcolor{keywordtype}{int} \_currFrameId, \textcolor{keywordtype}{byte}[] buffer, ref \textcolor{keywordtype}{int} bitposition)}
\DoxyCodeLine{00175         \{}
\DoxyCodeLine{00176             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00177             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onTickPreSerializations.Count; i < cnt; ++i)}
\DoxyCodeLine{00178                 onTickPreSerializations[i].OnPreSerializeTick(\_currFrameId, buffer, ref bitposition);}
\DoxyCodeLine{00179             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00180         \}}
\DoxyCodeLine{00181 }
\DoxyCodeLine{00182         \textcolor{comment}{//public static void OnPreDeserializeTickCallbacks(int \_currFrameId, byte[] buffer, ref int bitposition)}}
\DoxyCodeLine{00183         \textcolor{comment}{//\{}}
\DoxyCodeLine{00184         \textcolor{comment}{//    CallbacksLocked = true;}}
\DoxyCodeLine{00185         \textcolor{comment}{//    for (int i = 0, cnt = onTickPreSerializations.Count; i < cnt; ++i)}}
\DoxyCodeLine{00186         \textcolor{comment}{//        onTickPreSerializations[i].OnPreDeserializeTick(\_currFrameId, buffer, ref bitposition);}}
\DoxyCodeLine{00187         \textcolor{comment}{//    CallbacksLocked = false;}}
\DoxyCodeLine{00188         \textcolor{comment}{//\}}}
\DoxyCodeLine{00189 }
\DoxyCodeLine{00190         \textcolor{comment}{// LATE}}
\DoxyCodeLine{00191 }
\DoxyCodeLine{00192         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnPreSimulateCallbacks(\textcolor{keywordtype}{int} currentFrameId, \textcolor{keywordtype}{int} currentSubFrameId)}
\DoxyCodeLine{00193         \{}
\DoxyCodeLine{00194             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00195             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onPreSimulates.Count; i < cnt; ++i)}
\DoxyCodeLine{00196             \{}
\DoxyCodeLine{00197                 var cb = onPreSimulates[i];}
\DoxyCodeLine{00198                 var b = cb as UnityEngine.Behaviour;}
\DoxyCodeLine{00199                 \textcolor{keywordflow}{if} (!b || (b.isActiveAndEnabled \&\& b.gameObject.activeInHierarchy))}
\DoxyCodeLine{00200                     cb.OnPreSimulate(currentFrameId, currentSubFrameId);}
\DoxyCodeLine{00201             \}}
\DoxyCodeLine{00202             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00203         \}}
\DoxyCodeLine{00204         }
\DoxyCodeLine{00205         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnPostUpdateCallbacks()}
\DoxyCodeLine{00206         \{}
\DoxyCodeLine{00207             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00208             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onPostUpdates.Count; i < cnt; ++i)}
\DoxyCodeLine{00209             \{}
\DoxyCodeLine{00210                 var cb = onPostUpdates[i];}
\DoxyCodeLine{00211                 var b = cb as UnityEngine.Behaviour;}
\DoxyCodeLine{00212                 \textcolor{keywordflow}{if} (!b || (b.isActiveAndEnabled \&\& b.gameObject.activeInHierarchy))}
\DoxyCodeLine{00213                    cb.OnPostUpdate();}
\DoxyCodeLine{00214             \}}
\DoxyCodeLine{00215             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00216         \}}
\DoxyCodeLine{00217 }
\DoxyCodeLine{00218         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OnPostLateUpdateCallbacks()}
\DoxyCodeLine{00219         \{}
\DoxyCodeLine{00220             CallbacksLocked = \textcolor{keyword}{true};}
\DoxyCodeLine{00221             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0, cnt = onPostLateUpdates.Count; i < cnt; ++i)}
\DoxyCodeLine{00222             \{}
\DoxyCodeLine{00223                 var cb = onPostLateUpdates[i];}
\DoxyCodeLine{00224                 var b = cb as UnityEngine.Behaviour;}
\DoxyCodeLine{00225                 \textcolor{keywordflow}{if} (!b || (b.isActiveAndEnabled \&\& b.gameObject.activeInHierarchy))}
\DoxyCodeLine{00226                     cb.OnPostLateUpdate();}
\DoxyCodeLine{00227             \}}
\DoxyCodeLine{00228             CallbacksLocked = \textcolor{keyword}{false};}
\DoxyCodeLine{00229         \}}
\DoxyCodeLine{00230     \}}
\DoxyCodeLine{00231 }
\DoxyCodeLine{00232 \}}

\end{DoxyCode}
