\doxysection{Noise.\+cs}
\label{_noise_8cs_source}\index{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/PhotonUnityNetworking/Demos/DemoProcedural/Scripts/Noise.cs@{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/PhotonUnityNetworking/Demos/DemoProcedural/Scripts/Noise.cs}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{// Copyright(c) 2018, Benjamin Ward}}
\DoxyCodeLine{00002 \textcolor{comment}{// All rights reserved.}}
\DoxyCodeLine{00003    }
\DoxyCodeLine{00004 \textcolor{comment}{// Redistribution and use in source and binary forms, with or without}}
\DoxyCodeLine{00005 \textcolor{comment}{// modification, are permitted provided that the following conditions are met:}}
\DoxyCodeLine{00006    }
\DoxyCodeLine{00007 \textcolor{comment}{// * Redistributions of source code must retain the above copyright notice, this}}
\DoxyCodeLine{00008 \textcolor{comment}{//   list of conditions and the following disclaimer.}}
\DoxyCodeLine{00009    }
\DoxyCodeLine{00010 \textcolor{comment}{// * Redistributions in binary form must reproduce the above copyright notice,}}
\DoxyCodeLine{00011 \textcolor{comment}{//   this list of conditions and the following disclaimer in the documentation}}
\DoxyCodeLine{00012 \textcolor{comment}{//   and/or other materials provided with the distribution.}}
\DoxyCodeLine{00013    }
\DoxyCodeLine{00014 \textcolor{comment}{// * Neither the name of the copyright holder nor the names of its}}
\DoxyCodeLine{00015 \textcolor{comment}{//   contributors may be used to endorse or promote products derived from}}
\DoxyCodeLine{00016 \textcolor{comment}{//   this software without specific prior written permission.}}
\DoxyCodeLine{00017    }
\DoxyCodeLine{00018 \textcolor{comment}{// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "{}AS IS"{}}}
\DoxyCodeLine{00019 \textcolor{comment}{// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE}}
\DoxyCodeLine{00020 \textcolor{comment}{// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE}}
\DoxyCodeLine{00021 \textcolor{comment}{// DISCLAIMED.IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE}}
\DoxyCodeLine{00022 \textcolor{comment}{// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL}}
\DoxyCodeLine{00023 \textcolor{comment}{// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR}}
\DoxyCodeLine{00024 \textcolor{comment}{// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER}}
\DoxyCodeLine{00025 \textcolor{comment}{// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,}}
\DoxyCodeLine{00026 \textcolor{comment}{// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE}}
\DoxyCodeLine{00027 \textcolor{comment}{// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}}
\DoxyCodeLine{00028 }
\DoxyCodeLine{00029 \textcolor{comment}{// SimplexNoise for C\#}}
\DoxyCodeLine{00030 \textcolor{comment}{// Author: Benjamin Ward}}
\DoxyCodeLine{00031 \textcolor{comment}{// Github Link: https://github.com/WardBenjamin/SimplexNoise}}
\DoxyCodeLine{00032 \textcolor{comment}{// Originally authored by Heikki Törmälä}}
\DoxyCodeLine{00033 }
\DoxyCodeLine{00034 \textcolor{keyword}{using} System;}
\DoxyCodeLine{00035 }
\DoxyCodeLine{00036 \textcolor{keyword}{namespace }Simplex}
\DoxyCodeLine{00037 \{}
\DoxyCodeLine{00042     \textcolor{keyword}{public} \textcolor{keyword}{class }Noise}
\DoxyCodeLine{00043     \{}
\DoxyCodeLine{00044         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{float}[] Calc1D(\textcolor{keywordtype}{int} width, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{00045         \{}
\DoxyCodeLine{00046             \textcolor{keywordtype}{float}[] values = \textcolor{keyword}{new} \textcolor{keywordtype}{float}[width];}
\DoxyCodeLine{00047             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < width; i++)}
\DoxyCodeLine{00048                 values[i] = Generate(i * scale) * 128 + 128;}
\DoxyCodeLine{00049             \textcolor{keywordflow}{return} values;}
\DoxyCodeLine{00050         \}}
\DoxyCodeLine{00051 }
\DoxyCodeLine{00052         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{float}[,] Calc2D(\textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{00053         \{}
\DoxyCodeLine{00054             \textcolor{keywordtype}{float}[,] values = \textcolor{keyword}{new} \textcolor{keywordtype}{float}[width, height];}
\DoxyCodeLine{00055             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < width; i++)}
\DoxyCodeLine{00056                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < height; j++)}
\DoxyCodeLine{00057                     values[i, j] = Generate(i * scale, j * scale) * 128 + 128;}
\DoxyCodeLine{00058             \textcolor{keywordflow}{return} values;}
\DoxyCodeLine{00059         \}}
\DoxyCodeLine{00060 }
\DoxyCodeLine{00061         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{float}[,,] Calc3D(\textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{int} length, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{00062         \{}
\DoxyCodeLine{00063             \textcolor{keywordtype}{float}[,,] values = \textcolor{keyword}{new} \textcolor{keywordtype}{float}[width, height, length];}
\DoxyCodeLine{00064             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < width; i++)}
\DoxyCodeLine{00065                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < height; j++)}
\DoxyCodeLine{00066                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < length; k++)}
\DoxyCodeLine{00067                         values[i, j, k] = Generate(i * scale, j * scale, k * scale) * 128 + 128;}
\DoxyCodeLine{00068             \textcolor{keywordflow}{return} values;}
\DoxyCodeLine{00069         \}}
\DoxyCodeLine{00070 }
\DoxyCodeLine{00071         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{float} CalcPixel1D(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{00072         \{}
\DoxyCodeLine{00073             \textcolor{keywordflow}{return} Generate(x * scale) * 128 + 128;}
\DoxyCodeLine{00074         \}}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{float} CalcPixel2D(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{00077         \{}
\DoxyCodeLine{00078             \textcolor{keywordflow}{return} Generate(x * scale, y * scale) * 128 + 128;}
\DoxyCodeLine{00079         \}}
\DoxyCodeLine{00080 }
\DoxyCodeLine{00081         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{float} CalcPixel3D(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} z, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{00082         \{}
\DoxyCodeLine{00083             \textcolor{keywordflow}{return} Generate(x * scale, y * scale, z * scale) * 128 + 128;}
\DoxyCodeLine{00084         \}}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086         \textcolor{keyword}{static} Noise()}
\DoxyCodeLine{00087         \{}
\DoxyCodeLine{00088             perm = \textcolor{keyword}{new} \textcolor{keywordtype}{byte}[permOriginal.Length];}
\DoxyCodeLine{00089             Simplex.Noise.permOriginal.CopyTo(perm, 0);}
\DoxyCodeLine{00090         \}}
\DoxyCodeLine{00091 }
\DoxyCodeLine{00092         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{int} Seed}
\DoxyCodeLine{00093         \{}
\DoxyCodeLine{00094             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} seed; \}}
\DoxyCodeLine{00095             \textcolor{keyword}{set}}
\DoxyCodeLine{00096             \{}
\DoxyCodeLine{00097                 \textcolor{keywordflow}{if} (value == 0)}
\DoxyCodeLine{00098                 \{}
\DoxyCodeLine{00099                     perm = \textcolor{keyword}{new} \textcolor{keywordtype}{byte}[permOriginal.Length];}
\DoxyCodeLine{00100                     Simplex.Noise.permOriginal.CopyTo(perm, 0);}
\DoxyCodeLine{00101                 \}}
\DoxyCodeLine{00102                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{00103                 \{}
\DoxyCodeLine{00104                     perm = \textcolor{keyword}{new} \textcolor{keywordtype}{byte}[512];}
\DoxyCodeLine{00105                     Random random = \textcolor{keyword}{new} Random(value);}
\DoxyCodeLine{00106                     random.NextBytes(perm);}
\DoxyCodeLine{00107                 \}}
\DoxyCodeLine{00108             \}}
\DoxyCodeLine{00109         \}}
\DoxyCodeLine{00110         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{int} seed = 0;}
\DoxyCodeLine{00111 }
\DoxyCodeLine{00117         \textcolor{keyword}{internal} \textcolor{keyword}{static} \textcolor{keywordtype}{float} Generate(\textcolor{keywordtype}{float} x)}
\DoxyCodeLine{00118         \{}
\DoxyCodeLine{00119             \textcolor{keywordtype}{int} i0 = FastFloor(x);}
\DoxyCodeLine{00120             \textcolor{keywordtype}{int} i1 = i0 + 1;}
\DoxyCodeLine{00121             \textcolor{keywordtype}{float} x0 = x -\/ i0;}
\DoxyCodeLine{00122             \textcolor{keywordtype}{float} x1 = x0 -\/ 1.0f;}
\DoxyCodeLine{00123 }
\DoxyCodeLine{00124             \textcolor{keywordtype}{float} n0, n1;}
\DoxyCodeLine{00125 }
\DoxyCodeLine{00126             \textcolor{keywordtype}{float} t0 = 1.0f -\/ x0 * x0;}
\DoxyCodeLine{00127             t0 *= t0;}
\DoxyCodeLine{00128             n0 = t0 * t0 * grad(perm[i0 \& 0xff], x0);}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130             \textcolor{keywordtype}{float} t1 = 1.0f -\/ x1 * x1;}
\DoxyCodeLine{00131             t1 *= t1;}
\DoxyCodeLine{00132             n1 = t1 * t1 * grad(perm[i1 \& 0xff], x1);}
\DoxyCodeLine{00133             \textcolor{comment}{// The maximum value of this noise is 8*(3/4)\string^4 = 2.53125}}
\DoxyCodeLine{00134             \textcolor{comment}{// A factor of 0.395 scales to fit exactly within [-\/1,1]}}
\DoxyCodeLine{00135             \textcolor{keywordflow}{return} 0.395f * (n0 + n1);}
\DoxyCodeLine{00136         \}}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00144         \textcolor{keyword}{internal} \textcolor{keyword}{static} \textcolor{keywordtype}{float} Generate(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y)}
\DoxyCodeLine{00145         \{}
\DoxyCodeLine{00146             \textcolor{keyword}{const} \textcolor{keywordtype}{float} F2 = 0.366025403f; \textcolor{comment}{// F2 = 0.5*(sqrt(3.0)-\/1.0)}}
\DoxyCodeLine{00147             \textcolor{keyword}{const} \textcolor{keywordtype}{float} G2 = 0.211324865f; \textcolor{comment}{// G2 = (3.0-\/Math.sqrt(3.0))/6.0}}
\DoxyCodeLine{00148 }
\DoxyCodeLine{00149             \textcolor{keywordtype}{float} n0, n1, n2; \textcolor{comment}{// Noise contributions from the three corners}}
\DoxyCodeLine{00150 }
\DoxyCodeLine{00151             \textcolor{comment}{// Skew the input space to determine which simplex cell we're in}}
\DoxyCodeLine{00152             \textcolor{keywordtype}{float} s = (x + y) * F2; \textcolor{comment}{// Hairy factor for 2D}}
\DoxyCodeLine{00153             \textcolor{keywordtype}{float} xs = x + s;}
\DoxyCodeLine{00154             \textcolor{keywordtype}{float} ys = y + s;}
\DoxyCodeLine{00155             \textcolor{keywordtype}{int} i = FastFloor(xs);}
\DoxyCodeLine{00156             \textcolor{keywordtype}{int} j = FastFloor(ys);}
\DoxyCodeLine{00157 }
\DoxyCodeLine{00158             \textcolor{keywordtype}{float} t = (float)(i + j) * G2;}
\DoxyCodeLine{00159             \textcolor{keywordtype}{float} X0 = i -\/ t; \textcolor{comment}{// Unskew the cell origin back to (x,y) space}}
\DoxyCodeLine{00160             \textcolor{keywordtype}{float} Y0 = j -\/ t;}
\DoxyCodeLine{00161             \textcolor{keywordtype}{float} x0 = x -\/ X0; \textcolor{comment}{// The x,y distances from the cell origin}}
\DoxyCodeLine{00162             \textcolor{keywordtype}{float} y0 = y -\/ Y0;}
\DoxyCodeLine{00163 }
\DoxyCodeLine{00164             \textcolor{comment}{// For the 2D case, the simplex shape is an equilateral triangle.}}
\DoxyCodeLine{00165             \textcolor{comment}{// Determine which simplex we are in.}}
\DoxyCodeLine{00166             \textcolor{keywordtype}{int} i1, j1; \textcolor{comment}{// Offsets for second (middle) corner of simplex in (i,j) coords}}
\DoxyCodeLine{00167             \textcolor{keywordflow}{if} (x0 > y0) \{ i1 = 1; j1 = 0; \} \textcolor{comment}{// lower triangle, XY order: (0,0)-\/>(1,0)-\/>(1,1)}}
\DoxyCodeLine{00168             \textcolor{keywordflow}{else} \{ i1 = 0; j1 = 1; \}      \textcolor{comment}{// upper triangle, YX order: (0,0)-\/>(0,1)-\/>(1,1)}}
\DoxyCodeLine{00169 }
\DoxyCodeLine{00170             \textcolor{comment}{// A step of (1,0) in (i,j) means a step of (1-\/c,-\/c) in (x,y), and}}
\DoxyCodeLine{00171             \textcolor{comment}{// a step of (0,1) in (i,j) means a step of (-\/c,1-\/c) in (x,y), where}}
\DoxyCodeLine{00172             \textcolor{comment}{// c = (3-\/sqrt(3))/6}}
\DoxyCodeLine{00173 }
\DoxyCodeLine{00174             \textcolor{keywordtype}{float} x1 = x0 -\/ i1 + G2; \textcolor{comment}{// Offsets for middle corner in (x,y) unskewed coords}}
\DoxyCodeLine{00175             \textcolor{keywordtype}{float} y1 = y0 -\/ j1 + G2;}
\DoxyCodeLine{00176             \textcolor{keywordtype}{float} x2 = x0 -\/ 1.0f + 2.0f * G2; \textcolor{comment}{// Offsets for last corner in (x,y) unskewed coords}}
\DoxyCodeLine{00177             \textcolor{keywordtype}{float} y2 = y0 -\/ 1.0f + 2.0f * G2;}
\DoxyCodeLine{00178 }
\DoxyCodeLine{00179             \textcolor{comment}{// Wrap the integer indices at 256, to avoid indexing perm[] out of bounds}}
\DoxyCodeLine{00180             \textcolor{keywordtype}{int} ii = Mod(i, 256);}
\DoxyCodeLine{00181             \textcolor{keywordtype}{int} jj = Mod(j, 256);}
\DoxyCodeLine{00182 }
\DoxyCodeLine{00183             \textcolor{comment}{// Calculate the contribution from the three corners}}
\DoxyCodeLine{00184             \textcolor{keywordtype}{float} t0 = 0.5f -\/ x0 * x0 -\/ y0 * y0;}
\DoxyCodeLine{00185             \textcolor{keywordflow}{if} (t0 < 0.0f) n0 = 0.0f;}
\DoxyCodeLine{00186             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00187             \{}
\DoxyCodeLine{00188                 t0 *= t0;}
\DoxyCodeLine{00189                 n0 = t0 * t0 * grad(perm[ii + perm[jj]], x0, y0);}
\DoxyCodeLine{00190             \}}
\DoxyCodeLine{00191 }
\DoxyCodeLine{00192             \textcolor{keywordtype}{float} t1 = 0.5f -\/ x1 * x1 -\/ y1 * y1;}
\DoxyCodeLine{00193             \textcolor{keywordflow}{if} (t1 < 0.0f) n1 = 0.0f;}
\DoxyCodeLine{00194             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00195             \{}
\DoxyCodeLine{00196                 t1 *= t1;}
\DoxyCodeLine{00197                 n1 = t1 * t1 * grad(perm[ii + i1 + perm[jj + j1]], x1, y1);}
\DoxyCodeLine{00198             \}}
\DoxyCodeLine{00199 }
\DoxyCodeLine{00200             \textcolor{keywordtype}{float} t2 = 0.5f -\/ x2 * x2 -\/ y2 * y2;}
\DoxyCodeLine{00201             \textcolor{keywordflow}{if} (t2 < 0.0f) n2 = 0.0f;}
\DoxyCodeLine{00202             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00203             \{}
\DoxyCodeLine{00204                 t2 *= t2;}
\DoxyCodeLine{00205                 n2 = t2 * t2 * grad(perm[ii + 1 + perm[jj + 1]], x2, y2);}
\DoxyCodeLine{00206             \}}
\DoxyCodeLine{00207 }
\DoxyCodeLine{00208             \textcolor{comment}{// Add contributions from each corner to get the final noise value.}}
\DoxyCodeLine{00209             \textcolor{comment}{// The result is scaled to return values in the interval [-\/1,1].}}
\DoxyCodeLine{00210             \textcolor{keywordflow}{return} 40.0f * (n0 + n1 + n2); \textcolor{comment}{// TODO: The scale factor is preliminary!}}
\DoxyCodeLine{00211         \}}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213 }
\DoxyCodeLine{00214         \textcolor{keyword}{internal} \textcolor{keyword}{static} \textcolor{keywordtype}{float} Generate(\textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y, \textcolor{keywordtype}{float} z)}
\DoxyCodeLine{00215         \{}
\DoxyCodeLine{00216             \textcolor{comment}{// Simple skewing factors for the 3D case}}
\DoxyCodeLine{00217             \textcolor{keyword}{const} \textcolor{keywordtype}{float} F3 = 0.333333333f;}
\DoxyCodeLine{00218             \textcolor{keyword}{const} \textcolor{keywordtype}{float} G3 = 0.166666667f;}
\DoxyCodeLine{00219 }
\DoxyCodeLine{00220             \textcolor{keywordtype}{float} n0, n1, n2, n3; \textcolor{comment}{// Noise contributions from the four corners}}
\DoxyCodeLine{00221 }
\DoxyCodeLine{00222             \textcolor{comment}{// Skew the input space to determine which simplex cell we're in}}
\DoxyCodeLine{00223             \textcolor{keywordtype}{float} s = (x + y + z) * F3; \textcolor{comment}{// Very nice and simple skew factor for 3D}}
\DoxyCodeLine{00224             \textcolor{keywordtype}{float} xs = x + s;}
\DoxyCodeLine{00225             \textcolor{keywordtype}{float} ys = y + s;}
\DoxyCodeLine{00226             \textcolor{keywordtype}{float} zs = z + s;}
\DoxyCodeLine{00227             \textcolor{keywordtype}{int} i = FastFloor(xs);}
\DoxyCodeLine{00228             \textcolor{keywordtype}{int} j = FastFloor(ys);}
\DoxyCodeLine{00229             \textcolor{keywordtype}{int} k = FastFloor(zs);}
\DoxyCodeLine{00230 }
\DoxyCodeLine{00231             \textcolor{keywordtype}{float} t = (float)(i + j + k) * G3;}
\DoxyCodeLine{00232             \textcolor{keywordtype}{float} X0 = i -\/ t; \textcolor{comment}{// Unskew the cell origin back to (x,y,z) space}}
\DoxyCodeLine{00233             \textcolor{keywordtype}{float} Y0 = j -\/ t;}
\DoxyCodeLine{00234             \textcolor{keywordtype}{float} Z0 = k -\/ t;}
\DoxyCodeLine{00235             \textcolor{keywordtype}{float} x0 = x -\/ X0; \textcolor{comment}{// The x,y,z distances from the cell origin}}
\DoxyCodeLine{00236             \textcolor{keywordtype}{float} y0 = y -\/ Y0;}
\DoxyCodeLine{00237             \textcolor{keywordtype}{float} z0 = z -\/ Z0;}
\DoxyCodeLine{00238 }
\DoxyCodeLine{00239             \textcolor{comment}{// For the 3D case, the simplex shape is a slightly irregular tetrahedron.}}
\DoxyCodeLine{00240             \textcolor{comment}{// Determine which simplex we are in.}}
\DoxyCodeLine{00241             \textcolor{keywordtype}{int} i1, j1, k1; \textcolor{comment}{// Offsets for second corner of simplex in (i,j,k) coords}}
\DoxyCodeLine{00242             \textcolor{keywordtype}{int} i2, j2, k2; \textcolor{comment}{// Offsets for third corner of simplex in (i,j,k) coords}}
\DoxyCodeLine{00243 }
\DoxyCodeLine{00244             \textcolor{comment}{/* This code would benefit from a backport from the GLSL version! */}}
\DoxyCodeLine{00245             \textcolor{keywordflow}{if} (x0 >= y0)}
\DoxyCodeLine{00246             \{}
\DoxyCodeLine{00247                 \textcolor{keywordflow}{if} (y0 >= z0)}
\DoxyCodeLine{00248                 \{ i1 = 1; j1 = 0; k1 = 0; i2 = 1; j2 = 1; k2 = 0; \} \textcolor{comment}{// X Y Z order}}
\DoxyCodeLine{00249                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x0 >= z0) \{ i1 = 1; j1 = 0; k1 = 0; i2 = 1; j2 = 0; k2 = 1; \} \textcolor{comment}{// X Z Y order}}
\DoxyCodeLine{00250                 \textcolor{keywordflow}{else} \{ i1 = 0; j1 = 0; k1 = 1; i2 = 1; j2 = 0; k2 = 1; \} \textcolor{comment}{// Z X Y order}}
\DoxyCodeLine{00251             \}}
\DoxyCodeLine{00252             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00253             \{ \textcolor{comment}{// x0<y0}}
\DoxyCodeLine{00254                 \textcolor{keywordflow}{if} (y0 < z0) \{ i1 = 0; j1 = 0; k1 = 1; i2 = 0; j2 = 1; k2 = 1; \} \textcolor{comment}{// Z Y X order}}
\DoxyCodeLine{00255                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x0 < z0) \{ i1 = 0; j1 = 1; k1 = 0; i2 = 0; j2 = 1; k2 = 1; \} \textcolor{comment}{// Y Z X order}}
\DoxyCodeLine{00256                 \textcolor{keywordflow}{else} \{ i1 = 0; j1 = 1; k1 = 0; i2 = 1; j2 = 1; k2 = 0; \} \textcolor{comment}{// Y X Z order}}
\DoxyCodeLine{00257             \}}
\DoxyCodeLine{00258 }
\DoxyCodeLine{00259             \textcolor{comment}{// A step of (1,0,0) in (i,j,k) means a step of (1-\/c,-\/c,-\/c) in (x,y,z),}}
\DoxyCodeLine{00260             \textcolor{comment}{// a step of (0,1,0) in (i,j,k) means a step of (-\/c,1-\/c,-\/c) in (x,y,z), and}}
\DoxyCodeLine{00261             \textcolor{comment}{// a step of (0,0,1) in (i,j,k) means a step of (-\/c,-\/c,1-\/c) in (x,y,z), where}}
\DoxyCodeLine{00262             \textcolor{comment}{// c = 1/6.}}
\DoxyCodeLine{00263 }
\DoxyCodeLine{00264             \textcolor{keywordtype}{float} x1 = x0 -\/ i1 + G3; \textcolor{comment}{// Offsets for second corner in (x,y,z) coords}}
\DoxyCodeLine{00265             \textcolor{keywordtype}{float} y1 = y0 -\/ j1 + G3;}
\DoxyCodeLine{00266             \textcolor{keywordtype}{float} z1 = z0 -\/ k1 + G3;}
\DoxyCodeLine{00267             \textcolor{keywordtype}{float} x2 = x0 -\/ i2 + 2.0f * G3; \textcolor{comment}{// Offsets for third corner in (x,y,z) coords}}
\DoxyCodeLine{00268             \textcolor{keywordtype}{float} y2 = y0 -\/ j2 + 2.0f * G3;}
\DoxyCodeLine{00269             \textcolor{keywordtype}{float} z2 = z0 -\/ k2 + 2.0f * G3;}
\DoxyCodeLine{00270             \textcolor{keywordtype}{float} x3 = x0 -\/ 1.0f + 3.0f * G3; \textcolor{comment}{// Offsets for last corner in (x,y,z) coords}}
\DoxyCodeLine{00271             \textcolor{keywordtype}{float} y3 = y0 -\/ 1.0f + 3.0f * G3;}
\DoxyCodeLine{00272             \textcolor{keywordtype}{float} z3 = z0 -\/ 1.0f + 3.0f * G3;}
\DoxyCodeLine{00273 }
\DoxyCodeLine{00274             \textcolor{comment}{// Wrap the integer indices at 256, to avoid indexing perm[] out of bounds}}
\DoxyCodeLine{00275             \textcolor{keywordtype}{int} ii = Mod(i, 256);}
\DoxyCodeLine{00276             \textcolor{keywordtype}{int} jj = Mod(j, 256);}
\DoxyCodeLine{00277             \textcolor{keywordtype}{int} kk = Mod(k, 256);}
\DoxyCodeLine{00278 }
\DoxyCodeLine{00279             \textcolor{comment}{// Calculate the contribution from the four corners}}
\DoxyCodeLine{00280             \textcolor{keywordtype}{float} t0 = 0.6f -\/ x0 * x0 -\/ y0 * y0 -\/ z0 * z0;}
\DoxyCodeLine{00281             \textcolor{keywordflow}{if} (t0 < 0.0f) n0 = 0.0f;}
\DoxyCodeLine{00282             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00283             \{}
\DoxyCodeLine{00284                 t0 *= t0;}
\DoxyCodeLine{00285                 n0 = t0 * t0 * grad(perm[ii + perm[jj + perm[kk]]], x0, y0, z0);}
\DoxyCodeLine{00286             \}}
\DoxyCodeLine{00287 }
\DoxyCodeLine{00288             \textcolor{keywordtype}{float} t1 = 0.6f -\/ x1 * x1 -\/ y1 * y1 -\/ z1 * z1;}
\DoxyCodeLine{00289             \textcolor{keywordflow}{if} (t1 < 0.0f) n1 = 0.0f;}
\DoxyCodeLine{00290             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00291             \{}
\DoxyCodeLine{00292                 t1 *= t1;}
\DoxyCodeLine{00293                 n1 = t1 * t1 * grad(perm[ii + i1 + perm[jj + j1 + perm[kk + k1]]], x1, y1, z1);}
\DoxyCodeLine{00294             \}}
\DoxyCodeLine{00295 }
\DoxyCodeLine{00296             \textcolor{keywordtype}{float} t2 = 0.6f -\/ x2 * x2 -\/ y2 * y2 -\/ z2 * z2;}
\DoxyCodeLine{00297             \textcolor{keywordflow}{if} (t2 < 0.0f) n2 = 0.0f;}
\DoxyCodeLine{00298             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00299             \{}
\DoxyCodeLine{00300                 t2 *= t2;}
\DoxyCodeLine{00301                 n2 = t2 * t2 * grad(perm[ii + i2 + perm[jj + j2 + perm[kk + k2]]], x2, y2, z2);}
\DoxyCodeLine{00302             \}}
\DoxyCodeLine{00303 }
\DoxyCodeLine{00304             \textcolor{keywordtype}{float} t3 = 0.6f -\/ x3 * x3 -\/ y3 * y3 -\/ z3 * z3;}
\DoxyCodeLine{00305             \textcolor{keywordflow}{if} (t3 < 0.0f) n3 = 0.0f;}
\DoxyCodeLine{00306             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00307             \{}
\DoxyCodeLine{00308                 t3 *= t3;}
\DoxyCodeLine{00309                 n3 = t3 * t3 * grad(perm[ii + 1 + perm[jj + 1 + perm[kk + 1]]], x3, y3, z3);}
\DoxyCodeLine{00310             \}}
\DoxyCodeLine{00311 }
\DoxyCodeLine{00312             \textcolor{comment}{// Add contributions from each corner to get the final noise value.}}
\DoxyCodeLine{00313             \textcolor{comment}{// The result is scaled to stay just inside [-\/1,1]}}
\DoxyCodeLine{00314             \textcolor{keywordflow}{return} 32.0f * (n0 + n1 + n2 + n3); \textcolor{comment}{// TODO: The scale factor is preliminary!}}
\DoxyCodeLine{00315         \}}
\DoxyCodeLine{00316 }
\DoxyCodeLine{00317         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{byte}[] perm;}
\DoxyCodeLine{00318 }
\DoxyCodeLine{00319         \textcolor{keyword}{private} \textcolor{keyword}{static} readonly \textcolor{keywordtype}{byte}[] permOriginal = \textcolor{keyword}{new} \textcolor{keywordtype}{byte}[]}
\DoxyCodeLine{00320         \{}
\DoxyCodeLine{00321             151,160,137,91,90,15,}
\DoxyCodeLine{00322             131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,}
\DoxyCodeLine{00323             190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,}
\DoxyCodeLine{00324             88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,}
\DoxyCodeLine{00325             77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,}
\DoxyCodeLine{00326             102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,}
\DoxyCodeLine{00327             135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,}
\DoxyCodeLine{00328             5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,}
\DoxyCodeLine{00329             223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,}
\DoxyCodeLine{00330             129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,}
\DoxyCodeLine{00331             251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,}
\DoxyCodeLine{00332             49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,}
\DoxyCodeLine{00333             138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180,}
\DoxyCodeLine{00334             151,160,137,91,90,15,}
\DoxyCodeLine{00335             131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,}
\DoxyCodeLine{00336             190, 6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,}
\DoxyCodeLine{00337             88,237,149,56,87,174,20,125,136,171,168, 68,175,74,165,71,134,139,48,27,166,}
\DoxyCodeLine{00338             77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,}
\DoxyCodeLine{00339             102,143,54, 65,25,63,161, 1,216,80,73,209,76,132,187,208, 89,18,169,200,196,}
\DoxyCodeLine{00340             135,130,116,188,159,86,164,100,109,198,173,186, 3,64,52,217,226,250,124,123,}
\DoxyCodeLine{00341             5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,}
\DoxyCodeLine{00342             223,183,170,213,119,248,152, 2,44,154,163, 70,221,153,101,155,167, 43,172,9,}
\DoxyCodeLine{00343             129,22,39,253, 19,98,108,110,79,113,224,232,178,185, 112,104,218,246,97,228,}
\DoxyCodeLine{00344             251,34,242,193,238,210,144,12,191,179,162,241, 81,51,145,235,249,14,239,107,}
\DoxyCodeLine{00345             49,192,214, 31,181,199,106,157,184, 84,204,176,115,121,50,45,127, 4,150,254,}
\DoxyCodeLine{00346             138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180}
\DoxyCodeLine{00347         \};}
\DoxyCodeLine{00348 }
\DoxyCodeLine{00349         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{int} FastFloor(\textcolor{keywordtype}{float} x)}
\DoxyCodeLine{00350         \{}
\DoxyCodeLine{00351             \textcolor{keywordflow}{return} (x > 0) ? ((int)x) : (((int)x) -\/ 1);}
\DoxyCodeLine{00352         \}}
\DoxyCodeLine{00353 }
\DoxyCodeLine{00354         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{int} Mod(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} m)}
\DoxyCodeLine{00355         \{}
\DoxyCodeLine{00356             \textcolor{keywordtype}{int} a = x \% m;}
\DoxyCodeLine{00357             \textcolor{keywordflow}{return} a < 0 ? a + m : a;}
\DoxyCodeLine{00358         \}}
\DoxyCodeLine{00359 }
\DoxyCodeLine{00360         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{float} grad(\textcolor{keywordtype}{int} hash, \textcolor{keywordtype}{float} x)}
\DoxyCodeLine{00361         \{}
\DoxyCodeLine{00362             \textcolor{keywordtype}{int} h = hash \& 15;}
\DoxyCodeLine{00363             \textcolor{keywordtype}{float} grad = 1.0f + (h \& 7);   \textcolor{comment}{// Gradient value 1.0, 2.0, ..., 8.0}}
\DoxyCodeLine{00364             \textcolor{keywordflow}{if} ((h \& 8) != 0) grad = -\/grad;         \textcolor{comment}{// Set a random sign for the gradient}}
\DoxyCodeLine{00365             \textcolor{keywordflow}{return} (grad * x);           \textcolor{comment}{// Multiply the gradient with the distance}}
\DoxyCodeLine{00366         \}}
\DoxyCodeLine{00367 }
\DoxyCodeLine{00368         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{float} grad(\textcolor{keywordtype}{int} hash, \textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y)}
\DoxyCodeLine{00369         \{}
\DoxyCodeLine{00370             \textcolor{keywordtype}{int} h = hash \& 7;      \textcolor{comment}{// Convert low 3 bits of hash code}}
\DoxyCodeLine{00371             \textcolor{keywordtype}{float} u = h < 4 ? x : y;  \textcolor{comment}{// into 8 simple gradient directions,}}
\DoxyCodeLine{00372             \textcolor{keywordtype}{float} v = h < 4 ? y : x;  \textcolor{comment}{// and compute the dot product with (x,y).}}
\DoxyCodeLine{00373             \textcolor{keywordflow}{return} ((h \& 1) != 0 ? -\/u : u) + ((h \& 2) != 0 ? -\/2.0f * v : 2.0f * v);}
\DoxyCodeLine{00374         \}}
\DoxyCodeLine{00375 }
\DoxyCodeLine{00376         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{float} grad(\textcolor{keywordtype}{int} hash, \textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y, \textcolor{keywordtype}{float} z)}
\DoxyCodeLine{00377         \{}
\DoxyCodeLine{00378             \textcolor{keywordtype}{int} h = hash \& 15;     \textcolor{comment}{// Convert low 4 bits of hash code into 12 simple}}
\DoxyCodeLine{00379             \textcolor{keywordtype}{float} u = h < 8 ? x : y; \textcolor{comment}{// gradient directions, and compute dot product.}}
\DoxyCodeLine{00380             \textcolor{keywordtype}{float} v = h < 4 ? y : h == 12 || h == 14 ? x : z; \textcolor{comment}{// Fix repeats at h = 12 to 15}}
\DoxyCodeLine{00381             \textcolor{keywordflow}{return} ((h \& 1) != 0 ? -\/u : u) + ((h \& 2) != 0 ? -\/v : v);}
\DoxyCodeLine{00382         \}}
\DoxyCodeLine{00383 }
\DoxyCodeLine{00384         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{float} grad(\textcolor{keywordtype}{int} hash, \textcolor{keywordtype}{float} x, \textcolor{keywordtype}{float} y, \textcolor{keywordtype}{float} z, \textcolor{keywordtype}{float} t)}
\DoxyCodeLine{00385         \{}
\DoxyCodeLine{00386             \textcolor{keywordtype}{int} h = hash \& 31;      \textcolor{comment}{// Convert low 5 bits of hash code into 32 simple}}
\DoxyCodeLine{00387             \textcolor{keywordtype}{float} u = h < 24 ? x : y; \textcolor{comment}{// gradient directions, and compute dot product.}}
\DoxyCodeLine{00388             \textcolor{keywordtype}{float} v = h < 16 ? y : z;}
\DoxyCodeLine{00389             \textcolor{keywordtype}{float} w = h < 8 ? z : t;}
\DoxyCodeLine{00390             \textcolor{keywordflow}{return} ((h \& 1) != 0 ? -\/u : u) + ((h \& 2) != 0 ? -\/v : v) + ((h \& 4) != 0 ? -\/w : w);}
\DoxyCodeLine{00391         \}}
\DoxyCodeLine{00392     \}}
\DoxyCodeLine{00393 \}}

\end{DoxyCode}
