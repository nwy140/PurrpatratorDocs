\doxysection{Room.\+cs}
\label{_room_8cs_source}\index{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/PhotonRealtime/Code/Room.cs@{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/PhotonRealtime/Code/Room.cs}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002 \textcolor{comment}{// <copyright file="{}Room.cs"{} company="{}Exit Games GmbH"{}>}}
\DoxyCodeLine{00003 \textcolor{comment}{//   Loadbalancing Framework for Photon -\/ Copyright (C) 2018 Exit Games GmbH}}
\DoxyCodeLine{00004 \textcolor{comment}{// </copyright>}}
\DoxyCodeLine{00005 \textcolor{comment}{// <summary>}}
\DoxyCodeLine{00006 \textcolor{comment}{//   The Room class resembles the properties known about the room in which}}
\DoxyCodeLine{00007 \textcolor{comment}{//   a game/match happens.}}
\DoxyCodeLine{00008 \textcolor{comment}{// </summary>}}
\DoxyCodeLine{00009 \textcolor{comment}{// <author>developer@photonengine.com</author>}}
\DoxyCodeLine{00010 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00011 }
\DoxyCodeLine{00012 \textcolor{preprocessor}{\#if UNITY\_4\_7 || UNITY\_5 || UNITY\_5\_3\_OR\_NEWER}}
\DoxyCodeLine{00013 \textcolor{preprocessor}{\#define SUPPORTED\_UNITY}}
\DoxyCodeLine{00014 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00015 }
\DoxyCodeLine{00016 }
\DoxyCodeLine{00017 \textcolor{keyword}{namespace }Photon.Realtime}
\DoxyCodeLine{00018 \{}
\DoxyCodeLine{00019     \textcolor{keyword}{using} System;}
\DoxyCodeLine{00020     \textcolor{keyword}{using} System.Collections;}
\DoxyCodeLine{00021     \textcolor{keyword}{using} System.Collections.Generic;}
\DoxyCodeLine{00022     \textcolor{keyword}{using} ExitGames.Client.Photon;}
\DoxyCodeLine{00023 }
\DoxyCodeLine{00024 \textcolor{preprocessor}{    \#if SUPPORTED\_UNITY || NETFX\_CORE}}
\DoxyCodeLine{00025     \textcolor{keyword}{using} Hashtable = ExitGames.Client.Photon.Hashtable;}
\DoxyCodeLine{00026     \textcolor{keyword}{using} SupportClass = ExitGames.Client.Photon.SupportClass;}
\DoxyCodeLine{00027 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{00028 }
\DoxyCodeLine{00029 }
\DoxyCodeLine{00040     \textcolor{keyword}{public} \textcolor{keyword}{class }Room : RoomInfo}
\DoxyCodeLine{00041     \{}
\DoxyCodeLine{00045         \textcolor{keyword}{public} LoadBalancingClient LoadBalancingClient \{ \textcolor{keyword}{get}; \textcolor{keyword}{set}; \}}
\DoxyCodeLine{00046 }
\DoxyCodeLine{00049         \textcolor{keyword}{public} \textcolor{keyword}{new} \textcolor{keywordtype}{string} Name}
\DoxyCodeLine{00050         \{}
\DoxyCodeLine{00051             \textcolor{keyword}{get}}
\DoxyCodeLine{00052             \{}
\DoxyCodeLine{00053                 \textcolor{keywordflow}{return} this.name;}
\DoxyCodeLine{00054             \}}
\DoxyCodeLine{00055 }
\DoxyCodeLine{00056             \textcolor{keyword}{internal} \textcolor{keyword}{set}}
\DoxyCodeLine{00057             \{}
\DoxyCodeLine{00058                 this.name = value;}
\DoxyCodeLine{00059             \}}
\DoxyCodeLine{00060         \}}
\DoxyCodeLine{00061 }
\DoxyCodeLine{00062         \textcolor{keyword}{private} \textcolor{keywordtype}{bool} isOffline;}
\DoxyCodeLine{00063 }
\DoxyCodeLine{00064         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} IsOffline}
\DoxyCodeLine{00065         \{}
\DoxyCodeLine{00066             \textcolor{keyword}{get}}
\DoxyCodeLine{00067             \{}
\DoxyCodeLine{00068                 \textcolor{keywordflow}{return} isOffline;}
\DoxyCodeLine{00069             \}}
\DoxyCodeLine{00070 }
\DoxyCodeLine{00071             \textcolor{keyword}{private} \textcolor{keyword}{set}}
\DoxyCodeLine{00072             \{}
\DoxyCodeLine{00073                 isOffline = value;}
\DoxyCodeLine{00074             \}}
\DoxyCodeLine{00075         \}}
\DoxyCodeLine{00076 }
\DoxyCodeLine{00090         \textcolor{keyword}{public} \textcolor{keyword}{new} \textcolor{keywordtype}{bool} IsOpen}
\DoxyCodeLine{00091         \{}
\DoxyCodeLine{00092             \textcolor{keyword}{get}}
\DoxyCodeLine{00093             \{}
\DoxyCodeLine{00094                 \textcolor{keywordflow}{return} this.isOpen;}
\DoxyCodeLine{00095             \}}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097             \textcolor{keyword}{set}}
\DoxyCodeLine{00098             \{}
\DoxyCodeLine{00099                 \textcolor{keywordflow}{if} (value != this.isOpen)}
\DoxyCodeLine{00100                 \{}
\DoxyCodeLine{00101                     \textcolor{keywordflow}{if} (!this.isOffline)}
\DoxyCodeLine{00102                     \{}
\DoxyCodeLine{00103                         this.LoadBalancingClient.OpSetPropertiesOfRoom(\textcolor{keyword}{new} Hashtable() \{ \{ GamePropertyKey.IsOpen, value \} \});}
\DoxyCodeLine{00104                     \}}
\DoxyCodeLine{00105                 \}}
\DoxyCodeLine{00106 }
\DoxyCodeLine{00107                 this.isOpen = value;}
\DoxyCodeLine{00108             \}}
\DoxyCodeLine{00109         \}}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00121         \textcolor{keyword}{public} \textcolor{keyword}{new} \textcolor{keywordtype}{bool} IsVisible}
\DoxyCodeLine{00122         \{}
\DoxyCodeLine{00123             \textcolor{keyword}{get}}
\DoxyCodeLine{00124             \{}
\DoxyCodeLine{00125                 \textcolor{keywordflow}{return} this.isVisible;}
\DoxyCodeLine{00126             \}}
\DoxyCodeLine{00127 }
\DoxyCodeLine{00128             \textcolor{keyword}{set}}
\DoxyCodeLine{00129             \{}
\DoxyCodeLine{00130                 \textcolor{keywordflow}{if} (value != this.isVisible)}
\DoxyCodeLine{00131                 \{}
\DoxyCodeLine{00132                     \textcolor{keywordflow}{if} (!this.isOffline)}
\DoxyCodeLine{00133                     \{}
\DoxyCodeLine{00134                         this.LoadBalancingClient.OpSetPropertiesOfRoom(\textcolor{keyword}{new} Hashtable() \{ \{ GamePropertyKey.IsVisible, value \} \});}
\DoxyCodeLine{00135                     \}}
\DoxyCodeLine{00136                 \}}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138                 this.isVisible = value;}
\DoxyCodeLine{00139             \}}
\DoxyCodeLine{00140         \}}
\DoxyCodeLine{00141 }
\DoxyCodeLine{00150         \textcolor{keyword}{public} \textcolor{keyword}{new} \textcolor{keywordtype}{byte} MaxPlayers}
\DoxyCodeLine{00151         \{}
\DoxyCodeLine{00152             \textcolor{keyword}{get}}
\DoxyCodeLine{00153             \{}
\DoxyCodeLine{00154                 \textcolor{keywordflow}{return} this.maxPlayers;}
\DoxyCodeLine{00155             \}}
\DoxyCodeLine{00156 }
\DoxyCodeLine{00157             \textcolor{keyword}{set}}
\DoxyCodeLine{00158             \{}
\DoxyCodeLine{00159                 \textcolor{keywordflow}{if} (value != this.maxPlayers)}
\DoxyCodeLine{00160                 \{}
\DoxyCodeLine{00161                     \textcolor{keywordflow}{if} (!this.isOffline)}
\DoxyCodeLine{00162                     \{}
\DoxyCodeLine{00163                         this.LoadBalancingClient.OpSetPropertiesOfRoom(\textcolor{keyword}{new} Hashtable() \{ \{ GamePropertyKey.MaxPlayers, value \} \});}
\DoxyCodeLine{00164                     \}}
\DoxyCodeLine{00165                 \}}
\DoxyCodeLine{00166 }
\DoxyCodeLine{00167                 this.maxPlayers = value;}
\DoxyCodeLine{00168             \}}
\DoxyCodeLine{00169         \}}
\DoxyCodeLine{00170 }
\DoxyCodeLine{00172         \textcolor{keyword}{public} \textcolor{keyword}{new} \textcolor{keywordtype}{byte} PlayerCount}
\DoxyCodeLine{00173         \{}
\DoxyCodeLine{00174             \textcolor{keyword}{get}}
\DoxyCodeLine{00175             \{}
\DoxyCodeLine{00176                 \textcolor{keywordflow}{if} (this.Players == \textcolor{keyword}{null})}
\DoxyCodeLine{00177                 \{}
\DoxyCodeLine{00178                     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00179                 \}}
\DoxyCodeLine{00180 }
\DoxyCodeLine{00181                 \textcolor{keywordflow}{return} (\textcolor{keywordtype}{byte})this.Players.Count;}
\DoxyCodeLine{00182             \}}
\DoxyCodeLine{00183         \}}
\DoxyCodeLine{00184 }
\DoxyCodeLine{00186         \textcolor{keyword}{private} Dictionary<int, Player> players = \textcolor{keyword}{new} Dictionary<int, Player>();}
\DoxyCodeLine{00187 }
\DoxyCodeLine{00189         \textcolor{keyword}{public} Dictionary<int, Player> Players}
\DoxyCodeLine{00190         \{}
\DoxyCodeLine{00191             \textcolor{keyword}{get}}
\DoxyCodeLine{00192             \{}
\DoxyCodeLine{00193                 \textcolor{keywordflow}{return} this.players;}
\DoxyCodeLine{00194             \}}
\DoxyCodeLine{00195 }
\DoxyCodeLine{00196             \textcolor{keyword}{private} \textcolor{keyword}{set}}
\DoxyCodeLine{00197             \{}
\DoxyCodeLine{00198                 this.players = value;}
\DoxyCodeLine{00199             \}}
\DoxyCodeLine{00200         \}}
\DoxyCodeLine{00201 }
\DoxyCodeLine{00209         \textcolor{keyword}{public} \textcolor{keywordtype}{string}[] ExpectedUsers}
\DoxyCodeLine{00210         \{}
\DoxyCodeLine{00211             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} this.expectedUsers; \}}
\DoxyCodeLine{00212         \}}
\DoxyCodeLine{00213 }
\DoxyCodeLine{00215         \textcolor{keyword}{public} \textcolor{keywordtype}{int} PlayerTtl}
\DoxyCodeLine{00216         \{}
\DoxyCodeLine{00217             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} this.playerTtl; \}}
\DoxyCodeLine{00218 }
\DoxyCodeLine{00219             \textcolor{keyword}{set}}
\DoxyCodeLine{00220             \{}
\DoxyCodeLine{00221                 \textcolor{keywordflow}{if} (value != this.playerTtl)}
\DoxyCodeLine{00222                 \{}
\DoxyCodeLine{00223                     \textcolor{keywordflow}{if} (!this.isOffline)}
\DoxyCodeLine{00224                     \{}
\DoxyCodeLine{00225                         this.LoadBalancingClient.OpSetPropertyOfRoom(GamePropertyKey.PlayerTtl, value);  \textcolor{comment}{// TODO: implement Offline Mode}}
\DoxyCodeLine{00226                     \}}
\DoxyCodeLine{00227                 \}}
\DoxyCodeLine{00228 }
\DoxyCodeLine{00229                 this.playerTtl = value;}
\DoxyCodeLine{00230             \}}
\DoxyCodeLine{00231         \}}
\DoxyCodeLine{00232 }
\DoxyCodeLine{00234         \textcolor{keyword}{public} \textcolor{keywordtype}{int} EmptyRoomTtl}
\DoxyCodeLine{00235         \{}
\DoxyCodeLine{00236             \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} this.emptyRoomTtl; \}}
\DoxyCodeLine{00237 }
\DoxyCodeLine{00238             \textcolor{keyword}{set}}
\DoxyCodeLine{00239             \{}
\DoxyCodeLine{00240                 \textcolor{keywordflow}{if} (value != this.emptyRoomTtl)}
\DoxyCodeLine{00241                 \{}
\DoxyCodeLine{00242                     \textcolor{keywordflow}{if} (!this.isOffline)}
\DoxyCodeLine{00243                     \{}
\DoxyCodeLine{00244                         this.LoadBalancingClient.OpSetPropertyOfRoom(GamePropertyKey.EmptyRoomTtl, value);  \textcolor{comment}{// TODO: implement Offline Mode}}
\DoxyCodeLine{00245                     \}}
\DoxyCodeLine{00246                 \}}
\DoxyCodeLine{00247 }
\DoxyCodeLine{00248                 this.emptyRoomTtl = value;}
\DoxyCodeLine{00249             \}}
\DoxyCodeLine{00250         \}}
\DoxyCodeLine{00251 }
\DoxyCodeLine{00256         \textcolor{keyword}{public} \textcolor{keywordtype}{int} MasterClientId \{ \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} this.masterClientId; \} \}}
\DoxyCodeLine{00257 }
\DoxyCodeLine{00263         \textcolor{keyword}{public} \textcolor{keywordtype}{string}[] PropertiesListedInLobby}
\DoxyCodeLine{00264         \{}
\DoxyCodeLine{00265             \textcolor{keyword}{get}}
\DoxyCodeLine{00266             \{}
\DoxyCodeLine{00267                 \textcolor{keywordflow}{return} this.propertiesListedInLobby;}
\DoxyCodeLine{00268             \}}
\DoxyCodeLine{00269 }
\DoxyCodeLine{00270             \textcolor{keyword}{private} \textcolor{keyword}{set}}
\DoxyCodeLine{00271             \{}
\DoxyCodeLine{00272                 this.propertiesListedInLobby = value;}
\DoxyCodeLine{00273             \}}
\DoxyCodeLine{00274         \}}
\DoxyCodeLine{00275 }
\DoxyCodeLine{00286         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} AutoCleanUp}
\DoxyCodeLine{00287         \{}
\DoxyCodeLine{00288             \textcolor{keyword}{get}}
\DoxyCodeLine{00289             \{}
\DoxyCodeLine{00290                 \textcolor{keywordflow}{return} this.autoCleanUp;}
\DoxyCodeLine{00291             \}}
\DoxyCodeLine{00292         \}}
\DoxyCodeLine{00293 }
\DoxyCodeLine{00295         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} BroadcastPropertiesChangeToAll \{ \textcolor{keyword}{get}; \textcolor{keyword}{private} \textcolor{keyword}{set}; \}}
\DoxyCodeLine{00297         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} SuppressRoomEvents \{ \textcolor{keyword}{get}; \textcolor{keyword}{private} \textcolor{keyword}{set}; \}}
\DoxyCodeLine{00299         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} SuppressPlayerInfo \{ \textcolor{keyword}{get}; \textcolor{keyword}{private} \textcolor{keyword}{set}; \}}
\DoxyCodeLine{00301         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} PublishUserId \{ \textcolor{keyword}{get}; \textcolor{keyword}{private} \textcolor{keyword}{set}; \}}
\DoxyCodeLine{00303         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} DeleteNullProperties \{ \textcolor{keyword}{get}; \textcolor{keyword}{private} \textcolor{keyword}{set}; \}}
\DoxyCodeLine{00304 }
\DoxyCodeLine{00305 \textcolor{preprocessor}{        \#if SERVERSDK}}
\DoxyCodeLine{00307         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} CheckUserOnJoin \{ \textcolor{keyword}{get}; \textcolor{keyword}{private} \textcolor{keyword}{set}; \}}
\DoxyCodeLine{00308 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{00309 }
\DoxyCodeLine{00310 }
\DoxyCodeLine{00314         \textcolor{keyword}{public} Room(\textcolor{keywordtype}{string} roomName, RoomOptions options, \textcolor{keywordtype}{bool} isOffline = \textcolor{keyword}{false}) : base(roomName, options != null ? options.CustomRoomProperties : null)}
\DoxyCodeLine{00315         \{}
\DoxyCodeLine{00316             \textcolor{comment}{// base() sets name and (custom)properties. here we set "{}well known"{} properties}}
\DoxyCodeLine{00317             \textcolor{keywordflow}{if} (options != \textcolor{keyword}{null})}
\DoxyCodeLine{00318             \{}
\DoxyCodeLine{00319                 this.isVisible = options.IsVisible;}
\DoxyCodeLine{00320                 this.isOpen = options.IsOpen;}
\DoxyCodeLine{00321                 this.maxPlayers = options.MaxPlayers;}
\DoxyCodeLine{00322                 this.propertiesListedInLobby = options.CustomRoomPropertiesForLobby;}
\DoxyCodeLine{00323                 \textcolor{comment}{//this.playerTtl = options.PlayerTtl;       // set via well known properties}}
\DoxyCodeLine{00324                 \textcolor{comment}{//this.emptyRoomTtl = options.EmptyRoomTtl; // set via well known properties}}
\DoxyCodeLine{00325             \}}
\DoxyCodeLine{00326 }
\DoxyCodeLine{00327             this.isOffline = isOffline;}
\DoxyCodeLine{00328         \}}
\DoxyCodeLine{00329 }
\DoxyCodeLine{00330 }
\DoxyCodeLine{00334         \textcolor{keyword}{internal} \textcolor{keywordtype}{void} InternalCacheRoomFlags(\textcolor{keywordtype}{int} roomFlags)}
\DoxyCodeLine{00335         \{}
\DoxyCodeLine{00336             this.BroadcastPropertiesChangeToAll = (roomFlags \& (int)RoomOptionBit.BroadcastPropsChangeToAll) != 0;}
\DoxyCodeLine{00337             this.SuppressRoomEvents = (roomFlags \& (int)RoomOptionBit.SuppressRoomEvents) != 0;}
\DoxyCodeLine{00338             this.SuppressPlayerInfo = (roomFlags \& (int)RoomOptionBit.SuppressPlayerInfo) != 0;}
\DoxyCodeLine{00339             this.PublishUserId = (roomFlags \& (int)RoomOptionBit.PublishUserId) != 0;}
\DoxyCodeLine{00340             this.DeleteNullProperties = (roomFlags \& (int)RoomOptionBit.DeleteNullProps) != 0;}
\DoxyCodeLine{00341 \textcolor{preprocessor}{            \#if SERVERSDK}}
\DoxyCodeLine{00342             this.CheckUserOnJoin = (roomFlags \& (int)RoomOptionBit.CheckUserOnJoin) != 0;}
\DoxyCodeLine{00343 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{00344             this.autoCleanUp = (roomFlags \& (int)RoomOptionBit.DeleteCacheOnLeave) != 0;}
\DoxyCodeLine{00345         \}}
\DoxyCodeLine{00346 }
\DoxyCodeLine{00347         \textcolor{keyword}{protected} \textcolor{keyword}{internal} \textcolor{keyword}{override} \textcolor{keywordtype}{void} InternalCacheProperties(Hashtable propertiesToCache)}
\DoxyCodeLine{00348         \{}
\DoxyCodeLine{00349             \textcolor{keywordtype}{int} oldMasterId = this.masterClientId;}
\DoxyCodeLine{00350 }
\DoxyCodeLine{00351             base.InternalCacheProperties(propertiesToCache);    \textcolor{comment}{// important: updating the properties fields has no way to do callbacks on change}}
\DoxyCodeLine{00352 }
\DoxyCodeLine{00353             \textcolor{keywordflow}{if} (oldMasterId != 0 \&\& this.masterClientId != oldMasterId)}
\DoxyCodeLine{00354             \{}
\DoxyCodeLine{00355                 this.LoadBalancingClient.InRoomCallbackTargets.OnMasterClientSwitched(this.GetPlayer(this.masterClientId));}
\DoxyCodeLine{00356             \}}
\DoxyCodeLine{00357         \}}
\DoxyCodeLine{00358 }
\DoxyCodeLine{00405         \textcolor{keyword}{public} \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetCustomProperties(Hashtable propertiesToSet, Hashtable expectedProperties = \textcolor{keyword}{null}, WebFlags webFlags = \textcolor{keyword}{null})}
\DoxyCodeLine{00406         \{}
\DoxyCodeLine{00407             \textcolor{keywordflow}{if} (propertiesToSet == \textcolor{keyword}{null} || propertiesToSet.Count == 0)}
\DoxyCodeLine{00408             \{}
\DoxyCodeLine{00409                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00410             \}}
\DoxyCodeLine{00411             Hashtable customProps = propertiesToSet.StripToStringKeys() as Hashtable;}
\DoxyCodeLine{00412 }
\DoxyCodeLine{00413             \textcolor{keywordflow}{if} (this.isOffline)}
\DoxyCodeLine{00414             \{}
\DoxyCodeLine{00415                 \textcolor{keywordflow}{if} (customProps.Count == 0)}
\DoxyCodeLine{00416                 \{}
\DoxyCodeLine{00417                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00418                 \}}
\DoxyCodeLine{00419                 \textcolor{comment}{// Merge and delete values.}}
\DoxyCodeLine{00420                 this.CustomProperties.Merge(customProps);}
\DoxyCodeLine{00421                 this.CustomProperties.StripKeysWithNullValues();}
\DoxyCodeLine{00422 }
\DoxyCodeLine{00423                 \textcolor{comment}{// invoking callbacks}}
\DoxyCodeLine{00424                 this.LoadBalancingClient.InRoomCallbackTargets.OnRoomPropertiesUpdate(propertiesToSet);}
\DoxyCodeLine{00425                }
\DoxyCodeLine{00426             \}}
\DoxyCodeLine{00427             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00428             \{}
\DoxyCodeLine{00429                 \textcolor{comment}{// send (sync) these new values if in online room}}
\DoxyCodeLine{00430                 \textcolor{keywordflow}{return} this.LoadBalancingClient.OpSetPropertiesOfRoom(customProps, expectedProperties, webFlags);}
\DoxyCodeLine{00431             \}}
\DoxyCodeLine{00432 }
\DoxyCodeLine{00433             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00434         \}}
\DoxyCodeLine{00435 }
\DoxyCodeLine{00444         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} SetPropertiesListedInLobby(\textcolor{keywordtype}{string}[] lobbyProps)}
\DoxyCodeLine{00445         \{}
\DoxyCodeLine{00446             \textcolor{keywordflow}{if} (this.isOffline)}
\DoxyCodeLine{00447             \{}
\DoxyCodeLine{00448                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00449             \}}
\DoxyCodeLine{00450             Hashtable customProps = \textcolor{keyword}{new} Hashtable();}
\DoxyCodeLine{00451             customProps[GamePropertyKey.PropsListedInLobby] = lobbyProps;}
\DoxyCodeLine{00452             \textcolor{keywordflow}{return} this.LoadBalancingClient.OpSetPropertiesOfRoom(customProps);}
\DoxyCodeLine{00453         \}}
\DoxyCodeLine{00454 }
\DoxyCodeLine{00455 }
\DoxyCodeLine{00461         \textcolor{keyword}{protected} \textcolor{keyword}{internal} \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} RemovePlayer(Player player)}
\DoxyCodeLine{00462         \{}
\DoxyCodeLine{00463             this.Players.Remove(player.ActorNumber);}
\DoxyCodeLine{00464             player.RoomReference = \textcolor{keyword}{null};}
\DoxyCodeLine{00465         \}}
\DoxyCodeLine{00466 }
\DoxyCodeLine{00470         \textcolor{keyword}{protected} \textcolor{keyword}{internal} \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} RemovePlayer(\textcolor{keywordtype}{int} \textcolor{keywordtype}{id})}
\DoxyCodeLine{00471         \{}
\DoxyCodeLine{00472             this.RemovePlayer(this.GetPlayer(\textcolor{keywordtype}{id}));}
\DoxyCodeLine{00473         \}}
\DoxyCodeLine{00474 }
\DoxyCodeLine{00493         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} SetMasterClient(Player masterClientPlayer)}
\DoxyCodeLine{00494         \{}
\DoxyCodeLine{00495             \textcolor{keywordflow}{if} (this.isOffline)}
\DoxyCodeLine{00496             \{}
\DoxyCodeLine{00497                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00498             \}}
\DoxyCodeLine{00499             Hashtable newProps = \textcolor{keyword}{new} Hashtable() \{ \{ GamePropertyKey.MasterClientId, masterClientPlayer.ActorNumber \} \};}
\DoxyCodeLine{00500             Hashtable prevProps = \textcolor{keyword}{new} Hashtable() \{ \{ GamePropertyKey.MasterClientId, this.MasterClientId \} \};}
\DoxyCodeLine{00501             \textcolor{keywordflow}{return} this.LoadBalancingClient.OpSetPropertiesOfRoom(newProps, prevProps);}
\DoxyCodeLine{00502         \}}
\DoxyCodeLine{00503 }
\DoxyCodeLine{00509         \textcolor{keyword}{public} \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} AddPlayer(Player player)}
\DoxyCodeLine{00510         \{}
\DoxyCodeLine{00511             \textcolor{keywordflow}{if} (!this.Players.ContainsKey(player.ActorNumber))}
\DoxyCodeLine{00512             \{}
\DoxyCodeLine{00513                 this.StorePlayer(player);}
\DoxyCodeLine{00514                 \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00515             \}}
\DoxyCodeLine{00516 }
\DoxyCodeLine{00517             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00518         \}}
\DoxyCodeLine{00519 }
\DoxyCodeLine{00524         \textcolor{keyword}{public} \textcolor{keyword}{virtual} Player StorePlayer(Player player)}
\DoxyCodeLine{00525         \{}
\DoxyCodeLine{00526             this.Players[player.ActorNumber] = player;}
\DoxyCodeLine{00527             player.RoomReference = \textcolor{keyword}{this};}
\DoxyCodeLine{00528 }
\DoxyCodeLine{00530             \textcolor{comment}{//if (this.MasterClientId == 0 || player.ActorNumber < this.MasterClientId)}}
\DoxyCodeLine{00531             \textcolor{comment}{//\{}}
\DoxyCodeLine{00532             \textcolor{comment}{//    this.masterClientId = player.ActorNumber;}}
\DoxyCodeLine{00533             \textcolor{comment}{//\}}}
\DoxyCodeLine{00534 }
\DoxyCodeLine{00535             \textcolor{keywordflow}{return} player;}
\DoxyCodeLine{00536         \}}
\DoxyCodeLine{00537 }
\DoxyCodeLine{00545         \textcolor{keyword}{public} \textcolor{keyword}{virtual} Player GetPlayer(\textcolor{keywordtype}{int} \textcolor{keywordtype}{id}, \textcolor{keywordtype}{bool} findMaster = \textcolor{keyword}{false})}
\DoxyCodeLine{00546         \{}
\DoxyCodeLine{00547             \textcolor{keywordtype}{int} idToFind = (findMaster \&\& \textcolor{keywordtype}{id} == 0) ? this.MasterClientId : \textcolor{keywordtype}{id};}
\DoxyCodeLine{00548             }
\DoxyCodeLine{00549             Player result = \textcolor{keyword}{null};}
\DoxyCodeLine{00550             this.Players.TryGetValue(idToFind, out result);}
\DoxyCodeLine{00551 }
\DoxyCodeLine{00552             \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{00553         \}}
\DoxyCodeLine{00554 }
\DoxyCodeLine{00567         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} ClearExpectedUsers()}
\DoxyCodeLine{00568         \{}
\DoxyCodeLine{00569             \textcolor{keywordflow}{if} (this.ExpectedUsers == \textcolor{keyword}{null} || this.ExpectedUsers.Length == 0)}
\DoxyCodeLine{00570             \{}
\DoxyCodeLine{00571                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00572             \}}
\DoxyCodeLine{00573             \textcolor{keywordflow}{return} this.SetExpectedUsers(\textcolor{keyword}{new} \textcolor{keywordtype}{string}[0], this.ExpectedUsers);}
\DoxyCodeLine{00574         \}}
\DoxyCodeLine{00575 }
\DoxyCodeLine{00589         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} SetExpectedUsers(\textcolor{keywordtype}{string}[] newExpectedUsers)}
\DoxyCodeLine{00590         \{}
\DoxyCodeLine{00591             \textcolor{keywordflow}{if} (newExpectedUsers == \textcolor{keyword}{null} || newExpectedUsers.Length == 0)}
\DoxyCodeLine{00592             \{}
\DoxyCodeLine{00593                 this.LoadBalancingClient.DebugReturn(DebugLevel.ERROR, \textcolor{stringliteral}{"{}newExpectedUsers array is null or empty, call Room.ClearExpectedUsers() instead if this is what you want."{}});}
\DoxyCodeLine{00594                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00595             \}}
\DoxyCodeLine{00596             \textcolor{keywordflow}{return} this.SetExpectedUsers(newExpectedUsers, this.ExpectedUsers);}
\DoxyCodeLine{00597         \}}
\DoxyCodeLine{00598 }
\DoxyCodeLine{00599         \textcolor{keyword}{private} \textcolor{keywordtype}{bool} SetExpectedUsers(\textcolor{keywordtype}{string}[] newExpectedUsers, \textcolor{keywordtype}{string}[] oldExpectedUsers)}
\DoxyCodeLine{00600         \{}
\DoxyCodeLine{00601             \textcolor{keywordflow}{if} (this.isOffline)}
\DoxyCodeLine{00602             \{}
\DoxyCodeLine{00603                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00604             \}}
\DoxyCodeLine{00605             Hashtable gameProperties = \textcolor{keyword}{new} Hashtable(1);}
\DoxyCodeLine{00606             gameProperties.Add(GamePropertyKey.ExpectedUsers, newExpectedUsers);}
\DoxyCodeLine{00607             Hashtable expectedProperties = \textcolor{keyword}{null};}
\DoxyCodeLine{00608             \textcolor{keywordflow}{if} (oldExpectedUsers != \textcolor{keyword}{null})}
\DoxyCodeLine{00609             \{}
\DoxyCodeLine{00610                 expectedProperties = \textcolor{keyword}{new} Hashtable(1);}
\DoxyCodeLine{00611                 expectedProperties.Add(GamePropertyKey.ExpectedUsers, oldExpectedUsers);}
\DoxyCodeLine{00612             \}}
\DoxyCodeLine{00613             \textcolor{keywordflow}{return} this.LoadBalancingClient.OpSetPropertiesOfRoom(gameProperties, expectedProperties);}
\DoxyCodeLine{00614         \}}
\DoxyCodeLine{00615 }
\DoxyCodeLine{00618         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{string} ToString()}
\DoxyCodeLine{00619         \{}
\DoxyCodeLine{00620             \textcolor{keywordflow}{return} \textcolor{keywordtype}{string}.Format(\textcolor{stringliteral}{"{}Room: '\{0\}' \{1\},\{2\} \{4\}/\{3\} players."{}}, this.name, this.isVisible ? \textcolor{stringliteral}{"{}visible"{}} : \textcolor{stringliteral}{"{}hidden"{}}, this.isOpen ? \textcolor{stringliteral}{"{}open"{}} : \textcolor{stringliteral}{"{}closed"{}}, this.maxPlayers, this.PlayerCount);}
\DoxyCodeLine{00621         \}}
\DoxyCodeLine{00622 }
\DoxyCodeLine{00625         \textcolor{keyword}{public} \textcolor{keyword}{new} \textcolor{keywordtype}{string} ToStringFull()}
\DoxyCodeLine{00626         \{}
\DoxyCodeLine{00627             \textcolor{keywordflow}{return} \textcolor{keywordtype}{string}.Format(\textcolor{stringliteral}{"{}Room: '\{0\}' \{1\},\{2\} \{4\}/\{3\} players.\(\backslash\)ncustomProps: \{5\}"{}}, this.name, this.isVisible ? \textcolor{stringliteral}{"{}visible"{}} : \textcolor{stringliteral}{"{}hidden"{}}, this.isOpen ? \textcolor{stringliteral}{"{}open"{}} : \textcolor{stringliteral}{"{}closed"{}}, this.maxPlayers, this.PlayerCount, this.CustomProperties.ToStringFull());}
\DoxyCodeLine{00628         \}}
\DoxyCodeLine{00629     \}}
\DoxyCodeLine{00630 \}}

\end{DoxyCode}
