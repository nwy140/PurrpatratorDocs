\doxysection{Screen\+Quest\+Pointer.\+cs}
\label{_screen_quest_pointer_8cs_source}\index{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/\_Developers/Chan Kwok Chun/Scripts/ScreenQuestPointer.cs@{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/\_Developers/Chan Kwok Chun/Scripts/ScreenQuestPointer.cs}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{keyword}{using} System.Collections;}
\DoxyCodeLine{00002 \textcolor{keyword}{using} System.Collections.Generic;}
\DoxyCodeLine{00003 \textcolor{keyword}{using} UnityEngine;}
\DoxyCodeLine{00004 \textcolor{keyword}{using} UnityEngine.UI;}
\DoxyCodeLine{00005 }
\DoxyCodeLine{00006 \textcolor{keyword}{public} \textcolor{keyword}{class }ScreenQuestPointer : MonoBehaviour}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00008     GameObject Camera;}
\DoxyCodeLine{00009     [SerializeField] ScreenPointerVisualizer[] screenPointerVisualizers;}
\DoxyCodeLine{00010 }
\DoxyCodeLine{00011     \textcolor{keywordtype}{void} soundVisualUIInitialization()}
\DoxyCodeLine{00012     \{}
\DoxyCodeLine{00013         \textcolor{keywordtype}{int} VisualizerCounter = 0;}
\DoxyCodeLine{00014         \textcolor{keywordflow}{foreach} (ScreenPointerVisualizer soundVisualizer \textcolor{keywordflow}{in} screenPointerVisualizers)}
\DoxyCodeLine{00015         \{}
\DoxyCodeLine{00016             \textcolor{comment}{//Create or hold the canvas that is specified}}
\DoxyCodeLine{00017             GameObject canvas;}
\DoxyCodeLine{00018             \textcolor{keywordflow}{if} (soundVisualizer.canvas == \textcolor{keyword}{null})}
\DoxyCodeLine{00019             \{}
\DoxyCodeLine{00020                 canvas = \textcolor{keyword}{new} GameObject(\textcolor{stringliteral}{"{}Visualizer Canvas "{}} + VisualizerCounter++ + \textcolor{stringliteral}{"{}: "{}} + soundVisualizer.visualizerName);}
\DoxyCodeLine{00021                 Canvas c = canvas.AddComponent<Canvas>();}
\DoxyCodeLine{00022                 c.renderMode = RenderMode.ScreenSpaceOverlay;}
\DoxyCodeLine{00023                 CanvasScaler s = canvas.AddComponent<CanvasScaler>();}
\DoxyCodeLine{00024                 s.uiScaleMode = CanvasScaler.ScaleMode.ScaleWithScreenSize;}
\DoxyCodeLine{00025                 canvas.AddComponent<GraphicRaycaster>();}
\DoxyCodeLine{00026                 canvas.transform.SetParent(gameObject.transform);}
\DoxyCodeLine{00027             \}}
\DoxyCodeLine{00028             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (soundVisualizer.canvas.scene.name == \textcolor{keyword}{null}) \textcolor{comment}{// Check if it's prefab}}
\DoxyCodeLine{00029             \{}
\DoxyCodeLine{00030                 canvas = Instantiate(soundVisualizer.canvas);}
\DoxyCodeLine{00031                 canvas.transform.SetParent(gameObject.transform);}
\DoxyCodeLine{00032             \}}
\DoxyCodeLine{00033             \textcolor{keywordflow}{else} canvas = soundVisualizer.canvas;}
\DoxyCodeLine{00034 }
\DoxyCodeLine{00035             \textcolor{keywordtype}{int} VisualizerDynamicPartCounter = 0;}
\DoxyCodeLine{00036             \textcolor{keywordtype}{int} VisualizerStaticPartCounter = 0;}
\DoxyCodeLine{00037             \textcolor{keywordflow}{foreach} (ScreenQuestAssets soundVisualAssets \textcolor{keywordflow}{in} soundVisualizer.VisualizerDynamicPart)}
\DoxyCodeLine{00038             \{}
\DoxyCodeLine{00039                 GameObject Image = \textcolor{keyword}{new} GameObject(\textcolor{stringliteral}{"{}Visualizer Dynamic Asset "{}} + VisualizerDynamicPartCounter++);}
\DoxyCodeLine{00040                 Image image = Image.AddComponent<Image>();}
\DoxyCodeLine{00041                 image.sprite = soundVisualAssets.VisualSprite;}
\DoxyCodeLine{00042                 RectTransform transform = Image.GetComponent<RectTransform>();}
\DoxyCodeLine{00043                 transform.sizeDelta = \textcolor{keyword}{new} Vector2(soundVisualAssets.XSize, soundVisualAssets.YSize);}
\DoxyCodeLine{00044                 Color changeVisibility = image.color;}
\DoxyCodeLine{00045                 changeVisibility.a = 0;}
\DoxyCodeLine{00046                 image.color = changeVisibility;}
\DoxyCodeLine{00047 }
\DoxyCodeLine{00048                 Image.transform.SetParent(canvas.transform);}
\DoxyCodeLine{00049 }
\DoxyCodeLine{00050                 soundVisualAssets.ObjectImage = Image;}
\DoxyCodeLine{00051                 soundVisualAssets.RectImage = Image.GetComponent<RectTransform>();}
\DoxyCodeLine{00052                 soundVisualAssets.ComponentImage = image;}
\DoxyCodeLine{00053             \}}
\DoxyCodeLine{00054             \textcolor{keywordflow}{foreach} (ScreenQuestAssets soundVisualAssets \textcolor{keywordflow}{in} soundVisualizer.VisualizerStaticPart)}
\DoxyCodeLine{00055             \{}
\DoxyCodeLine{00056                 GameObject Image = \textcolor{keyword}{new} GameObject(\textcolor{stringliteral}{"{}Visualizer Static Asset "{}} + VisualizerStaticPartCounter++);}
\DoxyCodeLine{00057                 Image image = Image.AddComponent<Image>();}
\DoxyCodeLine{00058                 image.sprite = soundVisualAssets.VisualSprite;}
\DoxyCodeLine{00059                 RectTransform transform = Image.GetComponent<RectTransform>();}
\DoxyCodeLine{00060                 transform.sizeDelta = \textcolor{keyword}{new} Vector2(soundVisualAssets.XSize, soundVisualAssets.YSize);}
\DoxyCodeLine{00061                 Color changeVisibility = image.color;}
\DoxyCodeLine{00062                 changeVisibility.a = 0;}
\DoxyCodeLine{00063                 image.color = changeVisibility;}
\DoxyCodeLine{00064 }
\DoxyCodeLine{00065                 Image.transform.SetParent(canvas.transform);}
\DoxyCodeLine{00066 }
\DoxyCodeLine{00067                 soundVisualAssets.ObjectImage = Image;}
\DoxyCodeLine{00068                 soundVisualAssets.RectImage = Image.GetComponent<RectTransform>();}
\DoxyCodeLine{00069                 soundVisualAssets.ComponentImage = image;}
\DoxyCodeLine{00070 }
\DoxyCodeLine{00071             \}}
\DoxyCodeLine{00072             soundVisualizer.canvas = canvas;}
\DoxyCodeLine{00073         \}}
\DoxyCodeLine{00074     \}}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076     \textcolor{keyword}{private} \textcolor{keywordtype}{void} Awake()}
\DoxyCodeLine{00077     \{}
\DoxyCodeLine{00078         soundVisualUIInitialization();}
\DoxyCodeLine{00079     \}}
\DoxyCodeLine{00080 }
\DoxyCodeLine{00081     \textcolor{keywordtype}{void} Update()}
\DoxyCodeLine{00082     \{}
\DoxyCodeLine{00083         \textcolor{keywordflow}{if} (Camera == \textcolor{keyword}{null})}
\DoxyCodeLine{00084         \{}
\DoxyCodeLine{00085             Camera = FindObjectOfType<AudioListener>().gameObject;}
\DoxyCodeLine{00086         \}}
\DoxyCodeLine{00087         Vector3 soundDirection = (transform.position -\/ Camera.transform.position).normalized;}
\DoxyCodeLine{00088         \textcolor{keywordtype}{float} DifferenciationY = Vector3.Dot(soundDirection, Camera.transform.right);}
\DoxyCodeLine{00089         \textcolor{keywordtype}{float} DifferenciationX = Vector3.Dot(soundDirection, Camera.transform.forward);}
\DoxyCodeLine{00090         \textcolor{keywordtype}{float} DifferenciationZ = Vector3.Dot(soundDirection, Camera.transform.up);}
\DoxyCodeLine{00091         \textcolor{keywordflow}{foreach} (ScreenPointerVisualizer screenPointerVisualizer \textcolor{keywordflow}{in} screenPointerVisualizers)}
\DoxyCodeLine{00092         \{}
\DoxyCodeLine{00093             CalculateVisualPositioning(screenPointerVisualizer, DifferenciationX, DifferenciationY, DifferenciationZ);}
\DoxyCodeLine{00094         \}}
\DoxyCodeLine{00095     \}}
\DoxyCodeLine{00096     \textcolor{keyword}{private} \textcolor{keywordtype}{void} CalculateVisualPositioning(ScreenPointerVisualizer screenPointerVisualizers, \textcolor{keywordtype}{float} fowardBack, \textcolor{keywordtype}{float} leftRight, \textcolor{keywordtype}{float} upDown) \textcolor{comment}{//Sets a normalized Vector2 for the positional direction the sprite should be within the Canvas screen, after that, a multiplier for how far they should be from the center.}}
\DoxyCodeLine{00097     \{}
\DoxyCodeLine{00098         Vector2 EncircleVector = \textcolor{keyword}{new} Vector2(leftRight, upDown).normalized;}
\DoxyCodeLine{00099         \textcolor{keywordflow}{foreach} (ScreenQuestAssets soundVisualAssets \textcolor{keywordflow}{in} screenPointerVisualizers.VisualizerDynamicPart)}
\DoxyCodeLine{00100         \{}
\DoxyCodeLine{00101             \textcolor{comment}{//soundVisualAssets.currentTime -\/= Time.deltaTime;}}
\DoxyCodeLine{00102             Vector2 RealVector = \textcolor{keyword}{new} Vector2(EncircleVector.x * soundVisualAssets.XVisualDistanceFromCenter, EncircleVector.y * soundVisualAssets.YVisualDistanceFromCenter);}
\DoxyCodeLine{00103             soundVisualAssets.RectImage.localPosition = RealVector;}
\DoxyCodeLine{00104             soundVisualAssets.ObjectImage.transform.up = RealVector;}
\DoxyCodeLine{00105 }
\DoxyCodeLine{00106             \textcolor{keywordtype}{float} a = Mathf.Min(Mathf.Max(1 -\/ fowardBack -\/ soundVisualAssets.VisualAngle, 0) / soundVisualAssets.VisualAngleBuffer, 1); \textcolor{comment}{//Calculate Visibility of UI Based on how close you are looking at them.}}
\DoxyCodeLine{00107             Color changeVisibility = soundVisualAssets.ComponentImage.color;}
\DoxyCodeLine{00108             changeVisibility.a = a;}
\DoxyCodeLine{00109             soundVisualAssets.ComponentImage.color = changeVisibility;}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111         \}}
\DoxyCodeLine{00112         \textcolor{keywordflow}{foreach} (ScreenQuestAssets soundVisualAssets \textcolor{keywordflow}{in} screenPointerVisualizers.VisualizerStaticPart)}
\DoxyCodeLine{00113         \{}
\DoxyCodeLine{00114             \textcolor{comment}{//soundVisualAssets.currentTime -\/= Time.deltaTime;}}
\DoxyCodeLine{00115             Vector2 RealVector = \textcolor{keyword}{new} Vector2(EncircleVector.x * soundVisualAssets.XVisualDistanceFromCenter, EncircleVector.y * soundVisualAssets.YVisualDistanceFromCenter);}
\DoxyCodeLine{00116             soundVisualAssets.RectImage.localPosition = RealVector;}
\DoxyCodeLine{00117             soundVisualAssets.ObjectImage.transform.localPosition = RealVector;}
\DoxyCodeLine{00118 }
\DoxyCodeLine{00119             \textcolor{keywordtype}{float} a = Mathf.Min(Mathf.Max(1 -\/ fowardBack -\/ soundVisualAssets.VisualAngle, 0) / soundVisualAssets.VisualAngleBuffer, 1); \textcolor{comment}{//Calculate Visibility of UI Based on how close you are looking at them.}}
\DoxyCodeLine{00120             Color changeVisibility = soundVisualAssets.ComponentImage.color;}
\DoxyCodeLine{00121             changeVisibility.a = a;}
\DoxyCodeLine{00122             soundVisualAssets.ComponentImage.color = changeVisibility;}
\DoxyCodeLine{00123 }
\DoxyCodeLine{00124         \}}
\DoxyCodeLine{00125     \}}
\DoxyCodeLine{00126 \}}
\DoxyCodeLine{00127 }
\DoxyCodeLine{00128 }
\DoxyCodeLine{00129 [System.Serializable]}
\DoxyCodeLine{00130 \textcolor{keyword}{public} \textcolor{keyword}{class }ScreenPointerVisualizer}
\DoxyCodeLine{00131 \{}
\DoxyCodeLine{00132     [Header(\textcolor{stringliteral}{"{}Vanilla Settings"{}})]}
\DoxyCodeLine{00133     [Tooltip(\textcolor{stringliteral}{"{}Sets the defaulting canvas, is none is set, one will be created, its recommended that you allow one to be created if the existing canvas already has a lot of UI."{}})]}
\DoxyCodeLine{00134     \textcolor{keyword}{public} GameObject canvas;}
\DoxyCodeLine{00135 }
\DoxyCodeLine{00136     [Header(\textcolor{stringliteral}{"{}Sound Visualizer Settings"{}})]}
\DoxyCodeLine{00137     [Tooltip(\textcolor{stringliteral}{"{}Sets the visualizer name."{}})]}
\DoxyCodeLine{00138     \textcolor{keyword}{public} \textcolor{keywordtype}{string} visualizerName;}
\DoxyCodeLine{00139     [Tooltip(\textcolor{stringliteral}{"{}Sets in the dynamic rotating part of the visual."{}})]}
\DoxyCodeLine{00140     \textcolor{keyword}{public} ScreenQuestAssets[] VisualizerDynamicPart;}
\DoxyCodeLine{00141     [Tooltip(\textcolor{stringliteral}{"{}Sets in the static unrotating part of the visual."{}})]}
\DoxyCodeLine{00142     \textcolor{keyword}{public} ScreenQuestAssets[] VisualizerStaticPart;}
\DoxyCodeLine{00143 }
\DoxyCodeLine{00144 \}}
\DoxyCodeLine{00145 }
\DoxyCodeLine{00146 [System.Serializable]}
\DoxyCodeLine{00147 \textcolor{keyword}{public} \textcolor{keyword}{class }ScreenQuestAssets}
\DoxyCodeLine{00148 \{}
\DoxyCodeLine{00149     [Tooltip(\textcolor{stringliteral}{"{}Sets in the visual part of the visual."{}})]}
\DoxyCodeLine{00150     \textcolor{keyword}{public} Sprite VisualSprite;}
\DoxyCodeLine{00151     [Tooltip(\textcolor{stringliteral}{"{}How far should the X-\/cord visual be from the center."{}})]}
\DoxyCodeLine{00152     [Min(0f)] \textcolor{keyword}{public} \textcolor{keywordtype}{float} XVisualDistanceFromCenter;}
\DoxyCodeLine{00153     [Tooltip(\textcolor{stringliteral}{"{}How far should the Y-\/cord visual be from the center."{}})]}
\DoxyCodeLine{00154     [Min(0f)] \textcolor{keyword}{public} \textcolor{keywordtype}{float} YVisualDistanceFromCenter;}
\DoxyCodeLine{00155     [Tooltip(\textcolor{stringliteral}{"{}The X size of the UI element."{}})]}
\DoxyCodeLine{00156     [Min(0f)] \textcolor{keyword}{public} \textcolor{keywordtype}{float} XSize;}
\DoxyCodeLine{00157     [Tooltip(\textcolor{stringliteral}{"{}The Y size of the UI element."{}})]}
\DoxyCodeLine{00158     [Min(0f)] \textcolor{keyword}{public} \textcolor{keywordtype}{float} YSize;}
\DoxyCodeLine{00159     [Tooltip(\textcolor{stringliteral}{"{}How close you are to looking at the source before this would disappear. This value has to be between 0 to 1"{}})]}
\DoxyCodeLine{00160     [Min(0f)] \textcolor{keyword}{public} \textcolor{keywordtype}{float} VisualAngle;}
\DoxyCodeLine{00161     [Tooltip(\textcolor{stringliteral}{"{}A buffer of visual angle to soften the transition of vanish. This value has to be between 0 to 1."{}})]}
\DoxyCodeLine{00162     [Min(0f)] \textcolor{keyword}{public} \textcolor{keywordtype}{float} VisualAngleBuffer;}
\DoxyCodeLine{00163 }
\DoxyCodeLine{00164     [HideInInspector] \textcolor{keyword}{public} GameObject ObjectImage;}
\DoxyCodeLine{00165     [HideInInspector] \textcolor{keyword}{public} RectTransform RectImage;}
\DoxyCodeLine{00166     [HideInInspector] \textcolor{keyword}{public} Image ComponentImage;}
\DoxyCodeLine{00167 }
\DoxyCodeLine{00168 \}}

\end{DoxyCode}
