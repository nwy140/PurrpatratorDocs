\doxysection{Simple\+OVRInput\+Sync.\+cs}
\label{_simple_o_v_r_input_sync_8cs_source}\index{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/Simple/Components/SyncOculus/SimpleOVRInputSync.cs@{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/Simple/Components/SyncOculus/SimpleOVRInputSync.cs}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 }
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#if OCULUS}}
\DoxyCodeLine{00003 }
\DoxyCodeLine{00004 \textcolor{preprocessor}{\#if USING\_XR\_MANAGEMENT \&\& USING\_XR\_SDK\_OCULUS}}
\DoxyCodeLine{00005 \textcolor{preprocessor}{\#define USING\_XR\_SDK}}
\DoxyCodeLine{00006 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00007 }
\DoxyCodeLine{00008 \textcolor{keyword}{using} System.Text;}
\DoxyCodeLine{00009 \textcolor{keyword}{using} UnityEngine;}
\DoxyCodeLine{00010 }
\DoxyCodeLine{00011 \textcolor{preprocessor}{\#if UNITY\_2017\_2\_OR\_NEWER}}
\DoxyCodeLine{00012 \textcolor{keyword}{using} InputTracking = UnityEngine.XR.InputTracking;}
\DoxyCodeLine{00013 \textcolor{keyword}{using} Node = UnityEngine.XR.XRNode;}
\DoxyCodeLine{00014 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00015 \textcolor{keyword}{using} InputTracking = UnityEngine.VR.InputTracking;}
\DoxyCodeLine{00016 \textcolor{keyword}{using} Node = UnityEngine.VR.VRNode;}
\DoxyCodeLine{00017 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00018 }
\DoxyCodeLine{00019 \textcolor{preprocessor}{\#if UNITY\_EDITOR}}
\DoxyCodeLine{00020 \textcolor{keyword}{using} UnityEditor;}
\DoxyCodeLine{00021 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00022 }
\DoxyCodeLine{00023 \textcolor{keyword}{namespace }Photon.Pun.Simple}
\DoxyCodeLine{00024 \{}
\DoxyCodeLine{00025     \textcolor{keyword}{public} \textcolor{keyword}{struct }OVRInputFrame}
\DoxyCodeLine{00026     \{}
\DoxyCodeLine{00027         \textcolor{keyword}{public} Vector3 bodyPos, bodyRot, headPos, handPosL, handPosR;}
\DoxyCodeLine{00028         \textcolor{keyword}{public} Vector2 stickL, stickR;}
\DoxyCodeLine{00029         \textcolor{keyword}{public} Quaternion headRot, handRotL, handRotR;}
\DoxyCodeLine{00030         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} a, b, x, y, thumbL, thumbR, gripL, gripR, triggerL, triggerR;}
\DoxyCodeLine{00031         \textcolor{keyword}{public} \textcolor{keywordtype}{float} triggerLValue, triggerRValue, gripLValue, gripRValue;}
\DoxyCodeLine{00032 }
\DoxyCodeLine{00033         \textcolor{keyword}{private} \textcolor{keyword}{static} StringBuilder sb;}
\DoxyCodeLine{00034         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{string} ToString()}
\DoxyCodeLine{00035         \{}
\DoxyCodeLine{00036             \textcolor{keywordflow}{if} (sb == \textcolor{keyword}{null})}
\DoxyCodeLine{00037                 sb = \textcolor{keyword}{new} StringBuilder();}
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039             sb.Length = 0;}
\DoxyCodeLine{00040             sb.Append(\textcolor{stringliteral}{"{}Body: "{}}).Append(bodyPos).Append(\textcolor{stringliteral}{"{} "{}}).Append(bodyRot).Append(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00041             sb.Append(\textcolor{stringliteral}{"{}Head: "{}}).Append(headPos).Append(\textcolor{stringliteral}{"{} "{}}).Append(headRot).Append(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00042             sb.Append(\textcolor{stringliteral}{"{}Left: "{}}).Append(handPosL).Append(\textcolor{stringliteral}{"{} "{}}).Append(handRotL).Append(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00043             sb.Append(\textcolor{stringliteral}{"{}Rght: "{}}).Append(handPosR).Append(\textcolor{stringliteral}{"{} "{}}).Append(handRotR).Append(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00044             sb.Append(\textcolor{stringliteral}{"{}Stick "{}}).Append(stickL).Append(\textcolor{stringliteral}{"{} <-\/> "{}}).Append(stickR).Append(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00045 }
\DoxyCodeLine{00046             sb.Append(\textcolor{stringliteral}{"{}Bttns "{}}).Append(a).Append(\textcolor{stringliteral}{"{} "{}}).Append(b).Append(\textcolor{stringliteral}{"{} "{}}).Append(x).Append(\textcolor{stringliteral}{"{} "{}}).Append(y).Append(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00047             sb.Append(\textcolor{stringliteral}{"{}Thumb "{}}).Append(thumbL).Append(\textcolor{stringliteral}{"{} "{}}).Append(thumbR).Append(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00048             sb.Append(\textcolor{stringliteral}{"{}Grip "{}}).Append(gripL).Append(\textcolor{stringliteral}{"{} "{}}).Append(gripR).Append(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00049             sb.Append(\textcolor{stringliteral}{"{}Trigger "{}}).Append(triggerL).Append(\textcolor{stringliteral}{"{} "{}}).Append(triggerR).Append(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00050 }
\DoxyCodeLine{00051             \textcolor{keywordflow}{return} sb.ToString();}
\DoxyCodeLine{00052         \}}
\DoxyCodeLine{00053     \}}
\DoxyCodeLine{00054 }
\DoxyCodeLine{00055     \textcolor{keyword}{public} \textcolor{keyword}{class }SimpleOVRInputSync : NetComponent}
\DoxyCodeLine{00056         , IOnPreSimulate}
\DoxyCodeLine{00057     \{}
\DoxyCodeLine{00058 }
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060         \textcolor{keyword}{public} OVRInputFrame PollInputs()}
\DoxyCodeLine{00061         \{}
\DoxyCodeLine{00062             \textcolor{keywordflow}{return} \textcolor{keyword}{new} OVRInputFrame()}
\DoxyCodeLine{00063             \{}
\DoxyCodeLine{00064                 bodyPos = PollVInput(Node.HardwareTracker, OVRPlugin.Node.TrackerOne, NodeStatePropertyType.Position),}
\DoxyCodeLine{00065                 bodyRot = PollVInput(Node.TrackingReference, OVRPlugin.Node.TrackerOne, NodeStatePropertyType.Orientation),}
\DoxyCodeLine{00066 }
\DoxyCodeLine{00067                 headPos = PollVInput(Node.HardwareTracker, OVRPlugin.Node.Head, NodeStatePropertyType.Position),}
\DoxyCodeLine{00068                 headRot = PollQInput(Node.Head, OVRPlugin.Node.Head, NodeStatePropertyType.Orientation),}
\DoxyCodeLine{00069 }
\DoxyCodeLine{00070                 handPosL = PollVInput(Node.LeftHand, OVRPlugin.Node.HandLeft, NodeStatePropertyType.Position),}
\DoxyCodeLine{00071                 handRotL = PollQInput(Node.LeftHand, OVRPlugin.Node.HandLeft, NodeStatePropertyType.Orientation),}
\DoxyCodeLine{00072 }
\DoxyCodeLine{00073                 handPosR = PollVInput(Node.RightHand, OVRPlugin.Node.HandRight, NodeStatePropertyType.Position),}
\DoxyCodeLine{00074                 handRotR = PollQInput(Node.RightHand, OVRPlugin.Node.HandRight, NodeStatePropertyType.Orientation),}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076                 stickR = OVRInput.Get(OVRInput.Axis2D.PrimaryThumbstick),}
\DoxyCodeLine{00077                 stickL = OVRInput.Get(OVRInput.Axis2D.SecondaryThumbstick),}
\DoxyCodeLine{00078 }
\DoxyCodeLine{00079                 a = OVRInput.Get(OVRInput.Button.One),}
\DoxyCodeLine{00080                 b = OVRInput.Get(OVRInput.Button.Two),}
\DoxyCodeLine{00081                 x = OVRInput.Get(OVRInput.Button.Three),}
\DoxyCodeLine{00082                 y = OVRInput.Get(OVRInput.Button.Four),}
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084                 thumbL = OVRInput.Get(OVRInput.Button.SecondaryThumbstick),}
\DoxyCodeLine{00085                 thumbR = OVRInput.Get(OVRInput.Button.PrimaryThumbstick),}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087                 gripL = OVRInput.Get(OVRInput.Button.SecondaryHandTrigger),}
\DoxyCodeLine{00088                 gripR = OVRInput.Get(OVRInput.Button.PrimaryHandTrigger),}
\DoxyCodeLine{00089 }
\DoxyCodeLine{00090                 triggerL = OVRInput.Get(OVRInput.Button.SecondaryIndexTrigger),}
\DoxyCodeLine{00091                 triggerR = OVRInput.Get(OVRInput.Button.PrimaryIndexTrigger),}
\DoxyCodeLine{00092 }
\DoxyCodeLine{00093                 triggerLValue = OVRInput.Get(OVRInput.Axis1D.SecondaryIndexTrigger),}
\DoxyCodeLine{00094                 triggerRValue = OVRInput.Get(OVRInput.Axis1D.PrimaryIndexTrigger),}
\DoxyCodeLine{00095 }
\DoxyCodeLine{00096                 gripLValue = OVRInput.Get(OVRInput.Axis1D.SecondaryHandTrigger),}
\DoxyCodeLine{00097                 gripRValue = OVRInput.Get(OVRInput.Axis1D.PrimaryHandTrigger),}
\DoxyCodeLine{00098             \};}
\DoxyCodeLine{00099         \}}
\DoxyCodeLine{00100 }
\DoxyCodeLine{00101         \textcolor{keyword}{private} Vector3 PollVInput(Node node, OVRPlugin.Node ovrNode, NodeStatePropertyType type)}
\DoxyCodeLine{00102         \{}
\DoxyCodeLine{00103             Vector3 value;}
\DoxyCodeLine{00104             OVRNodeStateProperties.GetNodeStatePropertyVector3(node, type, ovrNode, OVRPlugin.Step.Render, out value);}
\DoxyCodeLine{00105             \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{00106         \}}
\DoxyCodeLine{00107 }
\DoxyCodeLine{00108         \textcolor{keyword}{private} Quaternion PollQInput(Node node, OVRPlugin.Node ovrNode, NodeStatePropertyType type)}
\DoxyCodeLine{00109         \{}
\DoxyCodeLine{00110             Quaternion value;}
\DoxyCodeLine{00111             OVRNodeStateProperties.GetNodeStatePropertyQuaternion(node, type, ovrNode, OVRPlugin.Step.Render, out value);}
\DoxyCodeLine{00112             \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{00113                 }
\DoxyCodeLine{00114         \}}
\DoxyCodeLine{00115 }
\DoxyCodeLine{00116         \textcolor{keyword}{public} \textcolor{keywordtype}{void} OnPreSimulate(\textcolor{keywordtype}{int} frameId, \textcolor{keywordtype}{int} subFrameId)}
\DoxyCodeLine{00117         \{}
\DoxyCodeLine{00118             var val = PollInputs();}
\DoxyCodeLine{00119             SimpleOVRDebug.Clear();}
\DoxyCodeLine{00120             SimpleOVRDebug.Log(val.ToString());}
\DoxyCodeLine{00121         \}}
\DoxyCodeLine{00122     \}}
\DoxyCodeLine{00123 }
\DoxyCodeLine{00124 \textcolor{preprocessor}{\#if UNITY\_EDITOR}}
\DoxyCodeLine{00125     [CustomEditor(typeof(SimpleOVRInputSync))]}
\DoxyCodeLine{00126     [CanEditMultipleObjects]}
\DoxyCodeLine{00127     \textcolor{keyword}{public} \textcolor{keyword}{class }SimpleOVRInputSyncEditor : HeaderEditorBase}
\DoxyCodeLine{00128     \{}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130     \}}
\DoxyCodeLine{00131 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00132 }
\DoxyCodeLine{00133 \}}
\DoxyCodeLine{00134 }
\DoxyCodeLine{00135 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
