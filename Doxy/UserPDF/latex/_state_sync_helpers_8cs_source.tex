\doxysection{State\+Sync\+Helpers.\+cs}
\label{_state_sync_helpers_8cs_source}\index{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/Simple/Components/SyncState/StateSyncHelpers.cs@{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/Simple/Components/SyncState/StateSyncHelpers.cs}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 }
\DoxyCodeLine{00005 }
\DoxyCodeLine{00006 \textcolor{comment}{//using System.Collections.Generic;}}
\DoxyCodeLine{00007 \textcolor{comment}{//using UnityEngine;}}
\DoxyCodeLine{00008 }
\DoxyCodeLine{00009 \textcolor{comment}{//namespace Photon.Pun.Simple}}
\DoxyCodeLine{00010 \textcolor{comment}{//\{}}
\DoxyCodeLine{00011 \textcolor{comment}{//  public static class StateSyncHelpers}}
\DoxyCodeLine{00012 \textcolor{comment}{//  \{}}
\DoxyCodeLine{00013 \textcolor{comment}{//      /// <summary>}}
\DoxyCodeLine{00014 \textcolor{comment}{//      /// Apply the vectors (offset, pos, rot, velocity) in StateChangeInfo to the syncState object. Returns true if teleport is required for change.}}
\DoxyCodeLine{00015 \textcolor{comment}{//      /// </summary>}}
\DoxyCodeLine{00016 \textcolor{comment}{//      public static void ApplyVectors(this SyncState syncState, StateChangeInfo stateChangeInfo, Transform prevParent, List<IFlagTeleport> callbacks)}}
\DoxyCodeLine{00017 \textcolor{comment}{//      \{}}
\DoxyCodeLine{00018 }
\DoxyCodeLine{00019 \textcolor{comment}{//          Transform transform = syncState.transform;}}
\DoxyCodeLine{00020 }
\DoxyCodeLine{00021 \textcolor{comment}{//          /// For respawns just the pos/rot values are NET relative to he old parent.}}
\DoxyCodeLine{00022 \textcolor{comment}{//          //if (stateChangeInfo.respawn)}}
\DoxyCodeLine{00023 \textcolor{comment}{//          //\{}}
\DoxyCodeLine{00024 \textcolor{comment}{//          //  var mount = stateChangeInfo.mount;}}
\DoxyCodeLine{00025 \textcolor{comment}{//          //  var localPos = stateChangeInfo.offsetPos;}}
\DoxyCodeLine{00026 \textcolor{comment}{//          //  var localRot = stateChangeInfo.offsetRot;}}
\DoxyCodeLine{00027 }
\DoxyCodeLine{00028 \textcolor{comment}{//          //  int cnt = callbacks.Count;}}
\DoxyCodeLine{00029 \textcolor{comment}{//          //  for (int i = 0; i < cnt; i++)}}
\DoxyCodeLine{00030 \textcolor{comment}{//          //      callbacks[i].OnTeleport();}}
\DoxyCodeLine{00031 }
\DoxyCodeLine{00032 \textcolor{comment}{//          //  transform.parent = (mount) ? mount.transform : null;}}
\DoxyCodeLine{00033 }
\DoxyCodeLine{00034 \textcolor{comment}{//          //  if (localPos.HasValue)}}
\DoxyCodeLine{00035 \textcolor{comment}{//          //      transform.localPosition = localPos.Value;}}
\DoxyCodeLine{00036 \textcolor{comment}{//          //  if (localRot.HasValue)}}
\DoxyCodeLine{00037 \textcolor{comment}{//          //      transform.localEulerAngles = localRot.Value;}}
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039 \textcolor{comment}{//          //  return;}}
\DoxyCodeLine{00040 \textcolor{comment}{//          //\}}}
\DoxyCodeLine{00041 \textcolor{comment}{//          //else}}
\DoxyCodeLine{00042 \textcolor{comment}{//          //\{}}
\DoxyCodeLine{00043 \textcolor{comment}{//              //if (stateChangeInfo.offsetPos.HasValue)}}
\DoxyCodeLine{00044 \textcolor{comment}{//              //\{}}
\DoxyCodeLine{00045 \textcolor{comment}{//              //  \{}}
\DoxyCodeLine{00046 \textcolor{comment}{//              //      var parRot = prevParent ? prevParent.rotation : transform.rotation;}}
\DoxyCodeLine{00047 \textcolor{comment}{//              //      /// TODO: offset and vel likely should be part of the ChangeState itself}}
\DoxyCodeLine{00048 \textcolor{comment}{//              //      /// Apply offset before changing state}}
\DoxyCodeLine{00049 \textcolor{comment}{//              //      var localOffset = stateChangeInfo.offsetPos;}}
\DoxyCodeLine{00050 }
\DoxyCodeLine{00051 \textcolor{comment}{//              //      //Debug.Log(Time.time + "{} "{} + transform.name + "{} Dequeue "{} + transform.position + "{} "{} + transform.position + prevParent.rotation * localOffset);}}
\DoxyCodeLine{00052 \textcolor{comment}{//              //      //transform.position = transform.position + prevParent.rotation * localOffset.Value;}}
\DoxyCodeLine{00053 }
\DoxyCodeLine{00054 \textcolor{comment}{//              //      Vector3? pos = localOffset.HasValue ? (transform.position + parRot * localOffset.Value) : (Vector3?)null;}}
\DoxyCodeLine{00055 \textcolor{comment}{//              //      Vector3? rot = stateChangeInfo.offsetRot;}}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057 \textcolor{comment}{//              //      //int cnt = callbacks.Count;}}
\DoxyCodeLine{00058 \textcolor{comment}{//              //      //for (int i = 0; i < cnt; i++)}}
\DoxyCodeLine{00059 \textcolor{comment}{//              //      //  callbacks[i].OnTeleport();}}
\DoxyCodeLine{00060 }
\DoxyCodeLine{00061 \textcolor{comment}{//              //      transform.parent = null;}}
\DoxyCodeLine{00062 \textcolor{comment}{//              //      if (pos.HasValue)}}
\DoxyCodeLine{00063 \textcolor{comment}{//              //          transform.position = pos.Value;}}
\DoxyCodeLine{00064 \textcolor{comment}{//              //      if (rot.HasValue)}}
\DoxyCodeLine{00065 \textcolor{comment}{//              //          transform.eulerAngles = rot.Value;}}
\DoxyCodeLine{00066 \textcolor{comment}{//              //  \}}}
\DoxyCodeLine{00067 \textcolor{comment}{//              //\}}}
\DoxyCodeLine{00068 \textcolor{comment}{//          //\}}}
\DoxyCodeLine{00069 }
\DoxyCodeLine{00070 \textcolor{comment}{//          if (stateChangeInfo.velocity.HasValue)}}
\DoxyCodeLine{00071 \textcolor{comment}{//          \{}}
\DoxyCodeLine{00072 }
\DoxyCodeLine{00073 \textcolor{comment}{//              var rb = syncState.Rb;}}
\DoxyCodeLine{00074 \textcolor{comment}{//              if (rb)}}
\DoxyCodeLine{00075 \textcolor{comment}{//              \{}}
\DoxyCodeLine{00076 \textcolor{comment}{//                  if (!rb.isKinematic)}}
\DoxyCodeLine{00077 \textcolor{comment}{//                  \{}}
\DoxyCodeLine{00078 \textcolor{comment}{//                      rb.velocity = ((prevParent) ? prevParent.rotation : rb.rotation) * stateChangeInfo.velocity.Value;}}
\DoxyCodeLine{00079 \textcolor{comment}{//                  \}}}
\DoxyCodeLine{00080 \textcolor{comment}{//              \}}}
\DoxyCodeLine{00081 \textcolor{comment}{//              else}}
\DoxyCodeLine{00082 \textcolor{comment}{//              \{}}
\DoxyCodeLine{00083 \textcolor{comment}{//                  var rb2d = syncState.Rb2d;}}
\DoxyCodeLine{00084 \textcolor{comment}{//                  if (rb2d)}}
\DoxyCodeLine{00085 \textcolor{comment}{//                  \{}}
\DoxyCodeLine{00086 \textcolor{comment}{//                      if (!rb2d.isKinematic)}}
\DoxyCodeLine{00087 \textcolor{comment}{//                      \{}}
\DoxyCodeLine{00088 \textcolor{comment}{//                          rb2d.velocity = stateChangeInfo.velocity.Value;}}
\DoxyCodeLine{00089 \textcolor{comment}{//                      \}}}
\DoxyCodeLine{00090 \textcolor{comment}{//                  \}}}
\DoxyCodeLine{00091 \textcolor{comment}{//              \}}}
\DoxyCodeLine{00092 \textcolor{comment}{//          \}}}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094             }
\DoxyCodeLine{00095 \textcolor{comment}{//      \}}}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097 \textcolor{comment}{//  \}}}
\DoxyCodeLine{00098 \textcolor{comment}{//\}}}
\DoxyCodeLine{00099 }

\end{DoxyCode}
