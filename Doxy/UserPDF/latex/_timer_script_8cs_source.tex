\doxysection{Timer\+Script.\+cs}
\label{_timer_script_8cs_source}\index{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/\_Developers/Ainun/Scripts/TimerScript.cs@{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/\_Developers/Ainun/Scripts/TimerScript.cs}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{keyword}{using} System.Collections;}
\DoxyCodeLine{00002 \textcolor{keyword}{using} System.Collections.Generic;}
\DoxyCodeLine{00003 \textcolor{keyword}{using} UnityEngine;}
\DoxyCodeLine{00004 \textcolor{keyword}{using} UnityEngine.UI;}
\DoxyCodeLine{00005 \textcolor{keyword}{using} Photon.Pun;}
\DoxyCodeLine{00006 \textcolor{keyword}{using} UnityEngine.SceneManagement;}
\DoxyCodeLine{00007 \textcolor{comment}{//using Hashtable = ExitGames.Client.Photon.Hashtable;}}
\DoxyCodeLine{00008 }
\DoxyCodeLine{00009 \textcolor{keyword}{public} \textcolor{keyword}{class }TimerScript : MonoBehaviourPun, IPunObservable}
\DoxyCodeLine{00010 \{}
\DoxyCodeLine{00011     \textcolor{keyword}{public} \textcolor{keywordtype}{double} timeAmt = 60;}
\DoxyCodeLine{00012     \textcolor{keyword}{public} Text timerText;}
\DoxyCodeLine{00013     \textcolor{keyword}{public} GameObject timesUpPopup;}
\DoxyCodeLine{00014     \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} startTimer;}
\DoxyCodeLine{00015 }
\DoxyCodeLine{00016     \textcolor{comment}{//[SerializeField] bool startTimer = false;}}
\DoxyCodeLine{00017     \textcolor{comment}{//double timerCountdown;}}
\DoxyCodeLine{00018     \textcolor{comment}{//double startCountdown;}}
\DoxyCodeLine{00019     \textcolor{comment}{//Hashtable CustomValue;}}
\DoxyCodeLine{00020 }
\DoxyCodeLine{00021     \textcolor{comment}{//private void Start()}}
\DoxyCodeLine{00022     \textcolor{comment}{//\{}}
\DoxyCodeLine{00023     \textcolor{comment}{//    if(PhotonNetwork.LocalPlayer.IsMasterClient)}}
\DoxyCodeLine{00024     \textcolor{comment}{//    \{}}
\DoxyCodeLine{00025     \textcolor{comment}{//        CustomValue = new ExitGames.Client.Photon.Hashtable();}}
\DoxyCodeLine{00026     \textcolor{comment}{//        startCountdown = PhotonNetwork.Time;}}
\DoxyCodeLine{00027     \textcolor{comment}{//        startTimer = true;}}
\DoxyCodeLine{00028     \textcolor{comment}{//        CustomValue.Add("{}TimerCountdown"{}, startCountdown);}}
\DoxyCodeLine{00029     \textcolor{comment}{//        PhotonNetwork.CurrentRoom.SetCustomProperties(CustomValue);}}
\DoxyCodeLine{00030     \textcolor{comment}{//    \}}}
\DoxyCodeLine{00031 }
\DoxyCodeLine{00032     \textcolor{comment}{//    else}}
\DoxyCodeLine{00033     \textcolor{comment}{//    \{}}
\DoxyCodeLine{00034     \textcolor{comment}{//        startCountdown = double.Parse(PhotonNetwork.CurrentRoom.CustomProperties["{}TimerCountdown"{}].ToString());}}
\DoxyCodeLine{00035     \textcolor{comment}{//        startTimer = true;}}
\DoxyCodeLine{00036     \textcolor{comment}{//    \}}}
\DoxyCodeLine{00037 }
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039     \textcolor{comment}{//\}}}
\DoxyCodeLine{00040 }
\DoxyCodeLine{00041 }
\DoxyCodeLine{00042     \textcolor{keywordtype}{void} Update()}
\DoxyCodeLine{00043     \{}
\DoxyCodeLine{00044         \textcolor{comment}{//if (!startTimer)}}
\DoxyCodeLine{00045         \textcolor{comment}{//    return;}}
\DoxyCodeLine{00046 }
\DoxyCodeLine{00047         \textcolor{comment}{//timerCountdown = PhotonNetwork.Time -\/ startCountdown;}}
\DoxyCodeLine{00048 }
\DoxyCodeLine{00049         \textcolor{comment}{//if(timerCountdown >= timeAmt)}}
\DoxyCodeLine{00050         \textcolor{comment}{//\{}}
\DoxyCodeLine{00051         \textcolor{comment}{//    TimeUI(timeAmt);}}
\DoxyCodeLine{00052         \textcolor{comment}{//\}}}
\DoxyCodeLine{00053 }
\DoxyCodeLine{00054         \textcolor{keywordflow}{if} (!startTimer)}
\DoxyCodeLine{00055             \textcolor{keywordflow}{return};}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00058         \{}
\DoxyCodeLine{00059             \textcolor{keywordflow}{if} (timeAmt > 0)}
\DoxyCodeLine{00060             \{}
\DoxyCodeLine{00061                 timeAmt += Time.deltaTime;}
\DoxyCodeLine{00062             \}}
\DoxyCodeLine{00063 }
\DoxyCodeLine{00064             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00065             \{}
\DoxyCodeLine{00066                 timeAmt = 0;}
\DoxyCodeLine{00067 }
\DoxyCodeLine{00068             \}}
\DoxyCodeLine{00069 }
\DoxyCodeLine{00070             TimeUI(timeAmt);}
\DoxyCodeLine{00071         \}}
\DoxyCodeLine{00072     \}}
\DoxyCodeLine{00073 }
\DoxyCodeLine{00074     \textcolor{keywordtype}{void} TimeUI(\textcolor{keywordtype}{double} timeNumberInUI)}
\DoxyCodeLine{00075     \{}
\DoxyCodeLine{00076         \textcolor{keywordflow}{if}(timeNumberInUI < 0)}
\DoxyCodeLine{00077         \{}
\DoxyCodeLine{00078             timeNumberInUI = 0;}
\DoxyCodeLine{00079             startTimer = \textcolor{keyword}{false};}
\DoxyCodeLine{00080             timesUpPopup.SetActive(\textcolor{keyword}{true});}
\DoxyCodeLine{00081             StartCoroutine(WaitForChangeScene());}
\DoxyCodeLine{00082         \}}
\DoxyCodeLine{00083 }
\DoxyCodeLine{00084         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(timeNumberInUI <= 11)}
\DoxyCodeLine{00085         \{}
\DoxyCodeLine{00086             timerText.color = Color.red;}
\DoxyCodeLine{00087         \}}
\DoxyCodeLine{00088 }
\DoxyCodeLine{00089         \textcolor{keywordtype}{float} minutes = Mathf.FloorToInt((\textcolor{keywordtype}{float})timeNumberInUI / 60);}
\DoxyCodeLine{00090         \textcolor{keywordtype}{float} seconds = Mathf.FloorToInt((\textcolor{keywordtype}{float})timeNumberInUI \% 60);}
\DoxyCodeLine{00091 }
\DoxyCodeLine{00092         timerText.text = \textcolor{keywordtype}{string}.Format(\textcolor{stringliteral}{"{}\{0:00\}:\{1:00\}"{}}, minutes, seconds);}
\DoxyCodeLine{00093     \}}
\DoxyCodeLine{00094 }
\DoxyCodeLine{00095     \textcolor{keyword}{public} \textcolor{keywordtype}{void} OnPhotonSerializeView(PhotonStream stream, PhotonMessageInfo info)}
\DoxyCodeLine{00096     \{}
\DoxyCodeLine{00097         \textcolor{keywordflow}{if} (stream.IsWriting)}
\DoxyCodeLine{00098         \{}
\DoxyCodeLine{00099             stream.SendNext(timeAmt);}
\DoxyCodeLine{00100         \}}
\DoxyCodeLine{00101         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00102         \{}
\DoxyCodeLine{00103             timeAmt = (double)stream.ReceiveNext();}
\DoxyCodeLine{00104 }
\DoxyCodeLine{00105         \}}
\DoxyCodeLine{00106     \}}
\DoxyCodeLine{00107 }
\DoxyCodeLine{00108     IEnumerator WaitForChangeScene()}
\DoxyCodeLine{00109     \{}
\DoxyCodeLine{00110         yield \textcolor{keywordflow}{return} \textcolor{keyword}{new} WaitForSeconds(5f);}
\DoxyCodeLine{00111         SceneManager.LoadScene(\textcolor{stringliteral}{"{}ScoreCalculation"{}});}
\DoxyCodeLine{00112     \}}
\DoxyCodeLine{00113 \}}

\end{DoxyCode}
