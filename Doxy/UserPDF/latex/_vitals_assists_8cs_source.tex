\doxysection{Vitals\+Assists.\+cs}
\label{_vitals_assists_8cs_source}\index{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/Simple/Components/ContactSystems/SyncVitals/Assistants/VitalsAssists.cs@{C:/\_SSDSPEEDUP/2021/GPS/gps2\_purrpatrator/GPS2\_Purrpatrator/Assets/Photon/Simple/Components/ContactSystems/SyncVitals/Assistants/VitalsAssists.cs}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002 \textcolor{comment}{// <copyright>PhotonNetwork Framework for Unity -\/ Copyright (C) 2020 Exit Games GmbH</copyright>}}
\DoxyCodeLine{00003 \textcolor{comment}{// <author>developer@exitgames.com</author>}}
\DoxyCodeLine{00004 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00005 }
\DoxyCodeLine{00006 \textcolor{preprocessor}{\#if UNITY\_EDITOR}}
\DoxyCodeLine{00007 \textcolor{preprocessor}{\#if PUN\_2\_OR\_NEWER}}
\DoxyCodeLine{00008 }
\DoxyCodeLine{00009 \textcolor{keyword}{using} UnityEngine;}
\DoxyCodeLine{00010 \textcolor{keyword}{using} UnityEditor;}
\DoxyCodeLine{00011 \textcolor{keyword}{using} Photon.Utilities;}
\DoxyCodeLine{00012 \textcolor{keyword}{using} System.Collections.Generic;}
\DoxyCodeLine{00013 \textcolor{keyword}{using} Photon.Pun;}
\DoxyCodeLine{00014 }
\DoxyCodeLine{00015 \textcolor{keyword}{namespace }Photon.Pun.Simple.Assists}
\DoxyCodeLine{00016 \{}
\DoxyCodeLine{00017 }
\DoxyCodeLine{00018     \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{class }VitalsAssists}
\DoxyCodeLine{00019     \{}
\DoxyCodeLine{00020 }
\DoxyCodeLine{00021 }
\DoxyCodeLine{00022 }
\DoxyCodeLine{00023         [MenuItem(AssistHelpers.ADD\_TO\_OBJ\_FOLDER + \textcolor{stringliteral}{"{}System/Vitals"{}}, \textcolor{keyword}{false}, AssistHelpers.PRIORITY)]}
\DoxyCodeLine{00024         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} AddVitalsSystem()}
\DoxyCodeLine{00025         \{}
\DoxyCodeLine{00026             var go = NetObjectAssists.GetSelectedGameObject();}
\DoxyCodeLine{00027             \textcolor{keywordflow}{if} (!go)}
\DoxyCodeLine{00028                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{00029 }
\DoxyCodeLine{00030             AddSystem(go, \textcolor{keyword}{true});}
\DoxyCodeLine{00031         \}}
\DoxyCodeLine{00032 }
\DoxyCodeLine{00033 }
\DoxyCodeLine{00034         [MenuItem(AssistHelpers.ADD\_TO\_OBJ\_FOLDER + \textcolor{stringliteral}{"{}Vitals UI"{}}, \textcolor{keyword}{false}, AssistHelpers.PRIORITY)]}
\DoxyCodeLine{00035         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} GenerateVitalsUI()}
\DoxyCodeLine{00036         \{}
\DoxyCodeLine{00037             var selection = Selection.activeGameObject;}
\DoxyCodeLine{00038             GenerateVitalsUI(selection);}
\DoxyCodeLine{00039         \}}
\DoxyCodeLine{00040 }
\DoxyCodeLine{00041 }
\DoxyCodeLine{00042         \textcolor{keyword}{public} \textcolor{keyword}{static} SystemPresence GetSystemPresence(\textcolor{keyword}{this} GameObject go, params MonoBehaviour[] depends)}
\DoxyCodeLine{00043         \{}
\DoxyCodeLine{00044             var sv = go.transform.GetNestedComponentInChildren<SyncVitals, NetObject>(\textcolor{keyword}{true});}
\DoxyCodeLine{00045             \textcolor{keywordflow}{if} (!sv)}
\DoxyCodeLine{00046                 sv =go.transform.GetNestedComponentInParents<SyncVitals, NetObject>();}
\DoxyCodeLine{00047 }
\DoxyCodeLine{00048             \textcolor{keywordflow}{if} (sv)}
\DoxyCodeLine{00049             \{}
\DoxyCodeLine{00050                 \textcolor{keywordflow}{if} (sv.gameObject == go)}
\DoxyCodeLine{00051                     \textcolor{keywordflow}{return} SystemPresence.Complete;}
\DoxyCodeLine{00052                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{00053                     \textcolor{keywordflow}{return} SystemPresence.Nested;}
\DoxyCodeLine{00054 }
\DoxyCodeLine{00055             \}}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057             \textcolor{keywordflow}{if} (go.transform.GetNestedComponentInChildren<SyncVitals, NetObject>(\textcolor{keyword}{true}))}
\DoxyCodeLine{00058                 \textcolor{keywordflow}{return} SystemPresence.Partial;}
\DoxyCodeLine{00059             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00060                 \textcolor{keywordflow}{return} SystemPresence.Absent;}
\DoxyCodeLine{00061         \}}
\DoxyCodeLine{00062 }
\DoxyCodeLine{00063         \textcolor{keyword}{public} \textcolor{keyword}{static} List<SyncVitals> reuseableSyncVitals = \textcolor{keyword}{new} List<SyncVitals>();}
\DoxyCodeLine{00064 }
\DoxyCodeLine{00065         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} AddSystem(\textcolor{keyword}{this} GameObject go, \textcolor{keywordtype}{bool} add, params MonoBehaviour[] depends)}
\DoxyCodeLine{00066         \{}
\DoxyCodeLine{00067             \textcolor{keywordflow}{if} (add)}
\DoxyCodeLine{00068             \{}
\DoxyCodeLine{00069                 go.EnsureComponentExists<SyncVitals>();}
\DoxyCodeLine{00070                 \textcolor{keywordflow}{if} (!go.transform.GetNestedComponentInChildren<VitalUI, NetObject>(\textcolor{keyword}{true}))}
\DoxyCodeLine{00071                     VitalsAssists.GenerateVitalsUI(go);}
\DoxyCodeLine{00072             \}}
\DoxyCodeLine{00073 }
\DoxyCodeLine{00074             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00075             \{}
\DoxyCodeLine{00076                 go.transform.GetNestedComponentsInChildren<SyncVitals, NetObject>(reuseableSyncVitals);}
\DoxyCodeLine{00077                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = reuseableSyncVitals.Count -\/ 1; i >= 0; -\/-\/i)}
\DoxyCodeLine{00078                     Object.DestroyImmediate(reuseableSyncVitals[i]);}
\DoxyCodeLine{00079 }
\DoxyCodeLine{00080                 DestroyVitalsUI(go);}
\DoxyCodeLine{00081             \}}
\DoxyCodeLine{00082             }
\DoxyCodeLine{00083         \}}
\DoxyCodeLine{00084 }
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} DestroyVitalsUI(GameObject selection)}
\DoxyCodeLine{00087         \{}
\DoxyCodeLine{00088             var uigo = selection.transform.Find(\textcolor{stringliteral}{"{}Vitals UI"{}});}
\DoxyCodeLine{00089             \textcolor{keywordflow}{if} (uigo)}
\DoxyCodeLine{00090                 Object.DestroyImmediate(uigo.gameObject);}
\DoxyCodeLine{00091         \}}
\DoxyCodeLine{00092 }
\DoxyCodeLine{00093         \textcolor{keyword}{public} \textcolor{keyword}{static} GameObject GenerateVitalsUI(GameObject selection)}
\DoxyCodeLine{00094         \{}
\DoxyCodeLine{00095             \textcolor{keyword}{const} \textcolor{keywordtype}{float} PAD\_ABOVE\_OBJ\_BOUNDS = .1f;}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097             \textcolor{keywordflow}{if} (selection == \textcolor{keyword}{null})}
\DoxyCodeLine{00098             \{}
\DoxyCodeLine{00099                 Debug.LogWarning(\textcolor{stringliteral}{"{}No selected GameObject. Cannot search for Vitals."{}});}
\DoxyCodeLine{00100                 \textcolor{keywordflow}{return} \textcolor{keyword}{null};}
\DoxyCodeLine{00101             \}}
\DoxyCodeLine{00102 }
\DoxyCodeLine{00103             \textcolor{keywordflow}{if} (!selection.CheckReparentable())}
\DoxyCodeLine{00104                 \textcolor{keywordflow}{return} \textcolor{keyword}{null};}
\DoxyCodeLine{00105 }
\DoxyCodeLine{00106             var ivc = selection.GetComponentInChildren<IVitalsSystem>();}
\DoxyCodeLine{00107 }
\DoxyCodeLine{00108             \textcolor{keywordflow}{if} (ivc == \textcolor{keyword}{null})}
\DoxyCodeLine{00109             \{}
\DoxyCodeLine{00110                 Debug.LogWarning(\textcolor{stringliteral}{"{}No "{}} + typeof(IVitalsSystem).Name + \textcolor{stringliteral}{"{} found on selected GameObject. Cannot find Vitals."{}});}
\DoxyCodeLine{00111                 \textcolor{keywordflow}{return} \textcolor{keyword}{null};}
\DoxyCodeLine{00112             \}}
\DoxyCodeLine{00113 }
\DoxyCodeLine{00114             var ivcTransform = (ivc as Component).transform;}
\DoxyCodeLine{00115 }
\DoxyCodeLine{00116             var go = \textcolor{keyword}{new} GameObject(\textcolor{stringliteral}{"{}Vitals UI"{}});}
\DoxyCodeLine{00117             go.transform.parent = ivcTransform;}
\DoxyCodeLine{00118 }
\DoxyCodeLine{00119             var defs = ivc.Vitals.vitalDefs;}
\DoxyCodeLine{00120             \textcolor{keywordtype}{int} count = defs.Count;}
\DoxyCodeLine{00121 }
\DoxyCodeLine{00122             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < count; ++i)}
\DoxyCodeLine{00123             \{}
\DoxyCodeLine{00124                 var vgo = \textcolor{keyword}{new} GameObject(defs[i].VitalName.name + \textcolor{stringliteral}{"{} UI"{}});}
\DoxyCodeLine{00125                 vgo.transform.parent = go.transform;}
\DoxyCodeLine{00126                 VitalUI vitalUI = vgo.AddComponent<VitalUI>();}
\DoxyCodeLine{00127                 vitalUI.targetVital = defs[i].VitalName;}
\DoxyCodeLine{00128                 vitalUI.ApplyVitalsSource((UnityEngine.Object)ivc);}
\DoxyCodeLine{00129                 vitalUI.AddDefaultUIPrefab();}
\DoxyCodeLine{00130             \}}
\DoxyCodeLine{00131 }
\DoxyCodeLine{00132             \textcolor{keywordtype}{int} boundsfound;}
\DoxyCodeLine{00133             var bounds = selection.CollectMyBounds(BoundsTools.BoundsType.Both, out boundsfound, \textcolor{keyword}{true});}
\DoxyCodeLine{00134             var selectionpos = selection.transform.position;}
\DoxyCodeLine{00135             go.transform.position = \textcolor{keyword}{new} Vector3(selectionpos.x, bounds.max.y + bounds.size.y * PAD\_ABOVE\_OBJ\_BOUNDS, selectionpos.z);}
\DoxyCodeLine{00136 }
\DoxyCodeLine{00137             \textcolor{keywordflow}{return} go;}
\DoxyCodeLine{00138         \}}
\DoxyCodeLine{00139     \}}
\DoxyCodeLine{00140 }
\DoxyCodeLine{00141 \}}
\DoxyCodeLine{00142 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00143 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
